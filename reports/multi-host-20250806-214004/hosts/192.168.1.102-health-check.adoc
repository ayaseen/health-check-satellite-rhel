= RHEL Health Check Report

ifdef::env-github[]
:tip-caption: :bulb:
:note-caption: :information_source:
:important-caption: :heavy_exclamation_mark:
:caution-caption: :fire:
:warning-caption: :warning:
endif::[]

= Key

[cols="1,3", options=header]
|===
|Value
|Description

|
{set:cellbgcolor:#FF0000}
Changes Required
|
{set:cellbgcolor!}
Indicates Changes Required for system stability, subscription compliance, or other reason.

|
{set:cellbgcolor:#FEFE20}
Changes Recommended
|
{set:cellbgcolor!}
Indicates Changes Recommended to align with recommended practices, but not urgently required

|
{set:cellbgcolor:#A6B9BF}
N/A
|
{set:cellbgcolor!}
No advise given on line item. For line items which are data-only to provide context.

|
{set:cellbgcolor:#80E5FF}
Advisory
|
{set:cellbgcolor!}
No change required or recommended, but additional information provided.

|
{set:cellbgcolor:#00FF00}
No Change
|
{set:cellbgcolor!}
No change required. In alignment with recommended practices.

|
{set:cellbgcolor:#FFFFFF}
To Be Evaluated
|
{set:cellbgcolor!}
Not yet evaluated. Will appear only in draft copies.
|===

= Summary

[cols="1,2,2,3", options=header]
|===
|*Category*
|*Item Evaluated*
|*Observed Result*
|*Recommendation*

// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/time-timezone.item

// Category
|
{set:cellbgcolor!}
System Information

// Item Evaluated
a|
<<System Timezone>>

| System timezone is set to Asia/Riyadh 

| 
{set:cellbgcolor:#80E5FF}
Advisory

// ------------------------ITEM END

// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/time-sync.item

// Category
|
{set:cellbgcolor!}
System Information

// Item Evaluated
a|
<<Time Synchronization>>

| Time synchronization is not enabled 

| 
{set:cellbgcolor:#FEFE20}
Changes Recommended

// ------------------------ITEM END

// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/clock-consistency.item

// Category
|
{set:cellbgcolor!}
System Information

// Item Evaluated
a|
<<Clock Consistency>>

| System clock appears to be consistent 

| 
{set:cellbgcolor:#00FF00}
No Change

// ------------------------ITEM END

// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/system-hostname.item

// Category
|
{set:cellbgcolor!}
System Information

// Item Evaluated
a|
<<System Hostname>>

| Hostname '' resolves correctly 

| 
{set:cellbgcolor:#00FF00}
No Change

// ------------------------ITEM END

// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/rhel-version.item

// Category
|
{set:cellbgcolor!}
System Information

// Item Evaluated
a|
<<RHEL Version>>

| RHEL version could not be verified:  

| 
{set:cellbgcolor:#FEFE20}
Changes Recommended

// ------------------------ITEM END

// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/system-uptime.item

// Category
|
{set:cellbgcolor!}
System Information

// Item Evaluated
a|
<<System Uptime>>

| System was recently rebooted (less than 1 day ago) 

| 
{set:cellbgcolor:#80E5FF}
Advisory

// ------------------------ITEM END

// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/system-registration.item

// Category
|
{set:cellbgcolor!}
System Information

// Item Evaluated
a|
<<System Registration>>

| System is properly registered with Red Hat 

| 
{set:cellbgcolor:#00FF00}
No Change

// ------------------------ITEM END

// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/enabled-repos.item

// Category
|
{set:cellbgcolor!}
System Information

// Item Evaluated
a|
<<Enabled Repositories>>

| Could not determine required repositories for this RHEL version 

| 
{set:cellbgcolor:#80E5FF}
Advisory

// ------------------------ITEM END

// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/cluster-software.item

// Category
|
{set:cellbgcolor!}
Performance

// Item Evaluated
a|
<<Cluster Software>>

| No cluster software detected 

| 
{set:cellbgcolor:#A6B9BF}
Not Applicable

// ------------------------ITEM END

// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/cluster-names.item

// Category
|
{set:cellbgcolor!}
Performance

// Item Evaluated
a|
<<Cluster Name Resolution>>

| System hostname doesn't match any cluster node names 

| 
{set:cellbgcolor:#FEFE20}
Changes Recommended

// ------------------------ITEM END

// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/cluster-fencing.item

// Category
|
{set:cellbgcolor!}
Performance

// Item Evaluated
a|
<<Fencing Agents>>

| No cluster software detected 

| 
{set:cellbgcolor:#A6B9BF}
Not Applicable

// ------------------------ITEM END

// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/cluster-constraints.item

// Category
|
{set:cellbgcolor!}
Performance

// Item Evaluated
a|
<<Cluster Constraints>>

| No cluster software detected 

| 
{set:cellbgcolor:#A6B9BF}
Not Applicable

// ------------------------ITEM END

// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/cluster-autostart.item

// Category
|
{set:cellbgcolor!}
Performance

// Item Evaluated
a|
<<Cluster Autostart>>

| No cluster software detected 

| 
{set:cellbgcolor:#A6B9BF}
Not Applicable

// ------------------------ITEM END

// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/cluster-split-brain.item

// Category
|
{set:cellbgcolor!}
Performance

// Item Evaluated
a|
<<Split-Brain Prevention>>

| No cluster software detected 

| 
{set:cellbgcolor:#A6B9BF}
Not Applicable

// ------------------------ITEM END

// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/cpu-info.item

// Category
|
{set:cellbgcolor!}
Performance

// Item Evaluated
a|
<<CPU Information>>

| System has 2 CPU cores (AMD Ryzen Threadripper PRO 7965WX 24-Cores, Unknown) with normal utilization 

| 
{set:cellbgcolor:#00FF00}
No Change

// ------------------------ITEM END

// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/memory-physical.item

// Category
|
{set:cellbgcolor!}
Performance

// Item Evaluated
a|
<<Physical Memory>>

| Could not determine total physical memory 

| 
{set:cellbgcolor:#FEFE20}
Changes Recommended

// ------------------------ITEM END

// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/tuned-profile.item

// Category
|
{set:cellbgcolor!}
Performance

// Item Evaluated
a|
<<Tuned Profile>>

| No tuned profile is active 

| 
{set:cellbgcolor:#FEFE20}
Changes Recommended

// ------------------------ITEM END

// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/memory-swap.item

// Category
|
{set:cellbgcolor!}
Performance

// Item Evaluated
a|
<<Swap Configuration>>

| Swap space is configured correctly (6.00 GB) 

| 
{set:cellbgcolor:#00FF00}
No Change

// ------------------------ITEM END

// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/cpu-bottlenecks.item

// Category
|
{set:cellbgcolor!}
Performance

// Item Evaluated
a|
<<CPU Bottlenecks>>

| No CPU bottlenecks detected 

| 
{set:cellbgcolor:#00FF00}
No Change

// ------------------------ITEM END

// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/memory-vm-tuning.item

// Category
|
{set:cellbgcolor!}
Performance

// Item Evaluated
a|
<<VM Tuning Parameters>>

| VM tuning parameters are properly configured 

| 
{set:cellbgcolor:#00FF00}
No Change

// ------------------------ITEM END

// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/disk-io-performance.item

// Category
|
{set:cellbgcolor!}
Performance

// Item Evaluated
a|
<<I/O Performance>>

| I/O performance tuning parameters are appropriately configured 

| 
{set:cellbgcolor:#00FF00}
No Change

// ------------------------ITEM END

// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/system-performance.item

// Category
|
{set:cellbgcolor!}
Performance

// Item Evaluated
a|
<<System Performance>>

| System performance metrics are within acceptable ranges 

| 
{set:cellbgcolor:#00FF00}
No Change

// ------------------------ITEM END

// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/performance-bottlenecks.item

// Category
|
{set:cellbgcolor!}
Performance

// Item Evaluated
a|
<<Performance Bottlenecks>>

| No significant performance bottlenecks detected 

| 
{set:cellbgcolor:#00FF00}
No Change

// ------------------------ITEM END

// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/system-caches.item

// Category
|
{set:cellbgcolor!}
Performance

// Item Evaluated
a|
<<System Caches>>

| System cache settings are properly configured 

| 
{set:cellbgcolor:#00FF00}
No Change

// ------------------------ITEM END

// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/disk-usage.item

// Category
|
{set:cellbgcolor!}
Storage

// Item Evaluated
a|
<<Disk Usage>>

| All filesystems have acceptable disk usage levels 

| 
{set:cellbgcolor:#00FF00}
No Change

// ------------------------ITEM END

// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/disk-mount-points.item

// Category
|
{set:cellbgcolor!}
Storage

// Item Evaluated
a|
<<Mount Points>>

| Some mount points could be optimized with better options 

| 
{set:cellbgcolor:#80E5FF}
Advisory

// ------------------------ITEM END

// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/storage-multipath.item

// Category
|
{set:cellbgcolor!}
Storage

// Item Evaluated
a|
<<Multipath Configuration>>

| Multipath is not installed 

| 
{set:cellbgcolor:#A6B9BF}
Not Applicable

// ------------------------ITEM END

// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/storage-config.item

// Category
|
{set:cellbgcolor!}
Storage

// Item Evaluated
a|
<<Storage Configuration>>

| Storage is properly configured with LVM 

| 
{set:cellbgcolor:#00FF00}
No Change

// ------------------------ITEM END

// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/storage-filesystem-types.item

// Category
|
{set:cellbgcolor!}
Storage

// Item Evaluated
a|
<<Filesystem Types>>

| Using recommended filesystem types: xfs (8) 

| 
{set:cellbgcolor:#00FF00}
No Change

// ------------------------ITEM END

// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/storage-considerations-performance.item

// Category
|
{set:cellbgcolor!}
Storage

// Item Evaluated
a|
<<Storage Performance>>

| Storage performance settings appear to be appropriate 

| 
{set:cellbgcolor:#00FF00}
No Change

// ------------------------ITEM END

// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/storage-filesystem-errors.item

// Category
|
{set:cellbgcolor!}
Storage

// Item Evaluated
a|
<<Filesystem Errors>>

| Filesystem errors detected 

| 
{set:cellbgcolor:#FF0000}
Changes Required

// ------------------------ITEM END

// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/storage-considerations-reliability.item

// Category
|
{set:cellbgcolor!}
Storage

// Item Evaluated
a|
<<Storage Reliability>>

| Virtual machine - storage redundancy managed by hypervisor 

| 
{set:cellbgcolor:#00FF00}
No Change

// ------------------------ITEM END

// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/storage-considerations-capacity.item

// Category
|
{set:cellbgcolor!}
Storage

// Item Evaluated
a|
<<Storage Capacity>>

| Storage capacity appears to be adequate 

| 
{set:cellbgcolor:#00FF00}
No Change

// ------------------------ITEM END

// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/storage-partition-alignment.item

// Category
|
{set:cellbgcolor!}
Storage

// Item Evaluated
a|
<<Partition Alignment>>

| All partitions appear to be properly aligned 

| 
{set:cellbgcolor:#00FF00}
No Change

// ------------------------ITEM END

// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/kernel-version.item

// Category
|
{set:cellbgcolor!}
Security

// Item Evaluated
a|
<<Kernel Version>>

| Repository metadata is 20306 days old - unable to reliably determine if latest kernel is installed 

| 
{set:cellbgcolor:#FEFE20}
Changes Recommended

// ------------------------ITEM END

// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/kernel-firmware.item

// Category
|
{set:cellbgcolor!}
Security

// Item Evaluated
a|
<<BIOS/UEFI Firmware>>

| This is a virtual machine - firmware is managed by the hypervisor 

| 
{set:cellbgcolor:#80E5FF}
Advisory

// ------------------------ITEM END

// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/security-selinux.item

// Category
|
{set:cellbgcolor!}
Security

// Item Evaluated
a|
<<SELinux Status>>

| SELinux is properly configured and enforcing 

| 
{set:cellbgcolor:#00FF00}
No Change

// ------------------------ITEM END

// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/security-auditd.item

// Category
|
{set:cellbgcolor!}
Security

// Item Evaluated
a|
<<Audit Configuration>>

| Found 3 issues with audit configuration 

| 
{set:cellbgcolor:#FEFE20}
Changes Recommended

// ------------------------ITEM END

// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/kernel-unused-devices.item

// Category
|
{set:cellbgcolor!}
Security

// Item Evaluated
a|
<<Unused Devices>>

| This is a virtual machine - device management is handled by the hypervisor 

| 
{set:cellbgcolor:#A6B9BF}
Not Applicable

// ------------------------ITEM END

// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/security-password-policy.item

// Category
|
{set:cellbgcolor!}
Security

// Item Evaluated
a|
<<Password Policy>>

| Found 3 password policy issues 

| 
{set:cellbgcolor:#FEFE20}
Changes Recommended

// ------------------------ITEM END

// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/compliance-rhel-cis.item

// Category
|
{set:cellbgcolor!}
Security

// Item Evaluated
a|
<<RHEL CIS Compliance>>

| System has low compliance with RHEL CIS standards (35%) 

| 
{set:cellbgcolor:#FF0000}
Changes Required

// ------------------------ITEM END

// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/security-file-permissions.item

// Category
|
{set:cellbgcolor!}
Security

// Item Evaluated
a|
<<File Permissions>>

| Found 3 file permission issues 

| 
{set:cellbgcolor:#FEFE20}
Changes Recommended

// ------------------------ITEM END

// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/security-ssh-hardening.item

// Category
|
{set:cellbgcolor!}
Security

// Item Evaluated
a|
<<SSH Hardening>>

| Found 13 SSH hardening issues 

| 
{set:cellbgcolor:#FEFE20}
Changes Recommended

// ------------------------ITEM END

// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/security-root-account.item

// Category
|
{set:cellbgcolor!}
Security

// Item Evaluated
a|
<<Root Account Security>>

| Found 2 root account security issues 

| 
{set:cellbgcolor:#FEFE20}
Changes Recommended

// ------------------------ITEM END

// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/auth-central.item

// Category
|
{set:cellbgcolor!}
Security

// Item Evaluated
a|
<<Central Authentication>>

| No central authentication configuration detected 

| 
{set:cellbgcolor:#FF0000}
Changes Required

// ------------------------ITEM END

// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/security-shell-history.item

// Category
|
{set:cellbgcolor!}
Security

// Item Evaluated
a|
<<Shell History Configuration>>

| Found 2 shell history configuration issues 

| 
{set:cellbgcolor:#FEFE20}
Changes Recommended

// ------------------------ITEM END

// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/auth-sssd.item

// Category
|
{set:cellbgcolor!}
Security

// Item Evaluated
a|
<<SSSD Configuration>>

| SSSD is not installed 

| 
{set:cellbgcolor:#80E5FF}
Advisory

// ------------------------ITEM END

// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/auth-sudo-pam.item

// Category
|
{set:cellbgcolor!}
Security

// Item Evaluated
a|
<<Sudo and PAM>>

| Local users with root or sudo privileges detected 

| 
{set:cellbgcolor:#FF0000}
Changes Required

// ------------------------ITEM END

// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/auth-kerberos.item

// Category
|
{set:cellbgcolor!}
Security

// Item Evaluated
a|
<<Kerberos Configuration>>

| Kerberos is not configured on this system 

| 
{set:cellbgcolor:#A6B9BF}
Not Applicable

// ------------------------ITEM END

// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/backup-systems.item

// Category
|
{set:cellbgcolor!}
Services

// Item Evaluated
a|
<<Backup Systems>>

| Backup system appears to be configured 

| 
{set:cellbgcolor:#00FF00}
No Change

// ------------------------ITEM END

// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/backup-recovery.item

// Category
|
{set:cellbgcolor!}
Services

// Item Evaluated
a|
<<Recovery Process>>

| No evidence of recent recovery testing found 

| 
{set:cellbgcolor:#FEFE20}
Changes Recommended

// ------------------------ITEM END

// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/backup-application.item

// Category
|
{set:cellbgcolor!}
Services

// Item Evaluated
a|
<<Application Backups>>

| No applications requiring specialized backups detected 

| 
{set:cellbgcolor:#80E5FF}
Advisory

// ------------------------ITEM END

// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/logs-system-errors.item

// Category
|
{set:cellbgcolor!}
Services

// Item Evaluated
a|
<<System Logs Check>>

| Found 33 errors in system logs 

| 
{set:cellbgcolor:#FEFE20}
Changes Recommended

// ------------------------ITEM END

// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/logs-rotation.item

// Category
|
{set:cellbgcolor!}
Services

// Item Evaluated
a|
<<Log Rotation>>

| Found 2 log rotation issues 

| 
{set:cellbgcolor:#FEFE20}
Changes Recommended

// ------------------------ITEM END

// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/logs-system.item

// Category
|
{set:cellbgcolor!}
Services

// Item Evaluated
a|
<<Logging System>>

| No logging service is active 

| 
{set:cellbgcolor:#FEFE20}
Changes Recommended

// ------------------------ITEM END

// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/monitoring-logs.item

// Category
|
{set:cellbgcolor!}
Services

// Item Evaluated
a|
<<Centralized Logging>>

| No active logging services detected 

| 
{set:cellbgcolor:#FEFE20}
Changes Recommended

// ------------------------ITEM END

// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/monitoring-alerts.item

// Category
|
{set:cellbgcolor!}
Services

// Item Evaluated
a|
<<Alerting Rules>>

| Alerting rules appear to be configured 

| 
{set:cellbgcolor:#00FF00}
No Change

// ------------------------ITEM END

// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/monitoring-agents.item

// Category
|
{set:cellbgcolor!}
Services

// Item Evaluated
a|
<<Monitoring Agents>>

| Monitoring agents installed but not running 

| 
{set:cellbgcolor:#FEFE20}
Changes Recommended

// ------------------------ITEM END

// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/services-unnecessary.item

// Category
|
{set:cellbgcolor!}
Services

// Item Evaluated
a|
<<Unnecessary Services>>

| No unnecessary services were identified 

| 
{set:cellbgcolor:#00FF00}
No Change

// ------------------------ITEM END

// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/services-required.item

// Category
|
{set:cellbgcolor!}
Services

// Item Evaluated
a|
<<Required Services>>

| Found issues with 12 required services 

| 
{set:cellbgcolor:#FEFE20}
Changes Recommended

// ------------------------ITEM END

// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/boot-target.item

// Category
|
{set:cellbgcolor!}
Services

// Item Evaluated
a|
<<Boot Target>>

| Unusual default boot target:  

| 
{set:cellbgcolor:#FEFE20}
Changes Recommended

// ------------------------ITEM END

// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/boot-errors.item

// Category
|
{set:cellbgcolor!}
Services

// Item Evaluated
a|
<<Boot Errors>>

| Found 131 boot errors and 0 failed units 

| 
{set:cellbgcolor:#FEFE20}
Changes Recommended

// ------------------------ITEM END

// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/network-config.item

// Category
|
{set:cellbgcolor!}
Networking

// Item Evaluated
a|
<<Network Configuration>>

| Found 1 network configuration issues 

| 
{set:cellbgcolor:#FEFE20}
Changes Recommended

// ------------------------ITEM END

// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/connectivity-services.item

// Category
|
{set:cellbgcolor!}
Networking

// Item Evaluated
a|
<<Dependent Services>>

| 4 of 4 local services may be unreachable 

| 
{set:cellbgcolor:#80E5FF}
Advisory

// ------------------------ITEM END

// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/connectivity-dns.item

// Category
|
{set:cellbgcolor!}
Networking

// Item Evaluated
a|
<<DNS Records>>

| Found 2 DNS resolution issues 

| 
{set:cellbgcolor:#FEFE20}
Changes Recommended

// ------------------------ITEM END

// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/ha-multicast.item

// Category
|
{set:cellbgcolor!}
Networking

// Item Evaluated
a|
<<Multicast Configuration>>

| System is not a cluster member 

| 
{set:cellbgcolor:#A6B9BF}
Not Applicable

// ------------------------ITEM END

// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/ha-fencing-network.item

// Category
|
{set:cellbgcolor!}
Networking

// Item Evaluated
a|
<<Fencing Network>>

| System is not a cluster member 

| 
{set:cellbgcolor:#A6B9BF}
Not Applicable

// ------------------------ITEM END

// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/network-bonding.item

// Category
|
{set:cellbgcolor!}
Networking

// Item Evaluated
a|
<<Network Bonding/Teaming>>

| Network bonding is not applicable with only one network interface 

| 
{set:cellbgcolor:#A6B9BF}
Not Applicable

// ------------------------ITEM END

// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/connectivity-latency.item

// Category
|
{set:cellbgcolor!}
Networking

// Item Evaluated
a|
<<Network Latency>>

| Network latency to key systems is within acceptable ranges 

| 
{set:cellbgcolor:#00FF00}
No Change

// ------------------------ITEM END

// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/hostname-resolution.item

// Category
|
{set:cellbgcolor!}
Networking

// Item Evaluated
a|
<<Hostname Resolution>>

| Hostname resolution is working correctly 

| 
{set:cellbgcolor:#00FF00}
No Change

// ------------------------ITEM END

// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/network-mtu.item

// Category
|
{set:cellbgcolor!}
Networking

// Item Evaluated
a|
<<MTU Configuration>>

| Standard MTU (1500) is used on all interfaces 

| 
{set:cellbgcolor:#00FF00}
No Change

// ------------------------ITEM END

// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/firewall-rules.item

// Category
|
{set:cellbgcolor!}
Networking

// Item Evaluated
a|
<<Firewall Rules>>

| No firewall service is active 

| 
{set:cellbgcolor:#FEFE20}
Changes Recommended

// ------------------------ITEM END

// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/network-tcp-ip-hardening.item

// Category
|
{set:cellbgcolor!}
Networking

// Item Evaluated
a|
<<TCP/IP Stack Hardening>>

| Found 1 missing TCP/IP security settings 

| 
{set:cellbgcolor:#FEFE20}
Changes Recommended

// ------------------------ITEM END

// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/packages-repositories.item

// Category
|
{set:cellbgcolor!}
Updates

// Item Evaluated
a|
<<Enabled Repositories>>

| No repositories appear to be enabled 

| 
{set:cellbgcolor:#FEFE20}
Changes Recommended

// ------------------------ITEM END

// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/packages-security.item

// Category
|
{set:cellbgcolor!}
Updates

// Item Evaluated
a|
<<Security Patches>>

| System appears to have all security patches applied 

| 
{set:cellbgcolor:#00FF00}
No Change

// ------------------------ITEM END

// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/packages-unnecessary.item

// Category
|
{set:cellbgcolor!}
Updates

// Item Evaluated
a|
<<Unnecessary Packages>>

| No unnecessary or outdated packages detected 

| 
{set:cellbgcolor:#00FF00}
No Change

// ------------------------ITEM END

// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/packages-kernel.item

// Category
|
{set:cellbgcolor!}
Updates

// Item Evaluated
a|
<<Kernel Consistency>>

| Found 1 kernel consistency issues 

| 
{set:cellbgcolor:#FEFE20}
Changes Recommended

// ------------------------ITEM END

|===

<<<

{set:cellbgcolor!}

# System Information

[cols="1,2,2,3", options=header]
|===
|*Category*
|*Item Evaluated*
|*Observed Result*
|*Recommendation*

// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/time-timezone.item

// Category
|
{set:cellbgcolor!}
System Information

// Item Evaluated
a|
<<System Timezone>>

| System timezone is set to Asia/Riyadh 

| 
{set:cellbgcolor:#80E5FF}
Advisory

// ------------------------ITEM END
// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/time-sync.item

// Category
|
{set:cellbgcolor!}
System Information

// Item Evaluated
a|
<<Time Synchronization>>

| Time synchronization is not enabled 

| 
{set:cellbgcolor:#FEFE20}
Changes Recommended

// ------------------------ITEM END
// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/clock-consistency.item

// Category
|
{set:cellbgcolor!}
System Information

// Item Evaluated
a|
<<Clock Consistency>>

| System clock appears to be consistent 

| 
{set:cellbgcolor:#00FF00}
No Change

// ------------------------ITEM END
// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/system-hostname.item

// Category
|
{set:cellbgcolor!}
System Information

// Item Evaluated
a|
<<System Hostname>>

| Hostname '' resolves correctly 

| 
{set:cellbgcolor:#00FF00}
No Change

// ------------------------ITEM END
// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/rhel-version.item

// Category
|
{set:cellbgcolor!}
System Information

// Item Evaluated
a|
<<RHEL Version>>

| RHEL version could not be verified:  

| 
{set:cellbgcolor:#FEFE20}
Changes Recommended

// ------------------------ITEM END
// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/system-uptime.item

// Category
|
{set:cellbgcolor!}
System Information

// Item Evaluated
a|
<<System Uptime>>

| System was recently rebooted (less than 1 day ago) 

| 
{set:cellbgcolor:#80E5FF}
Advisory

// ------------------------ITEM END
// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/system-registration.item

// Category
|
{set:cellbgcolor!}
System Information

// Item Evaluated
a|
<<System Registration>>

| System is properly registered with Red Hat 

| 
{set:cellbgcolor:#00FF00}
No Change

// ------------------------ITEM END
// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/enabled-repos.item

// Category
|
{set:cellbgcolor!}
System Information

// Item Evaluated
a|
<<Enabled Repositories>>

| Could not determine required repositories for this RHEL version 

| 
{set:cellbgcolor:#80E5FF}
Advisory

// ------------------------ITEM END
|===

== System Timezone

[cols="^"] 
|===
|
{set:cellbgcolor:#80E5FF}
Advisory
|===

Timezone Information:
[source, bash]
----
           Universal time: Wed 2025-08-06 18:40:19 UTC
                 RTC time: Wed 2025-08-06 18:40:19
                Time zone: Asia/Riyadh (+03, +0300)
System clock synchronized: yes
              NTP service: active
          RTC in local TZ: no

----


Locale Information:
[source, bash]
----
    VC Keymap: us
   X11 Layout: us

----

**Observation**

System timezone is set to Asia/Riyadh

**Recommendation**

Verify that the timezone matches the physical location or operational requirements of the server.

To change timezone if needed: 'timedatectl set-timezone <timezone>'

Common timezones: Asia/Riyadh (Saudi Arabia), Europe/London (UK), America/New_York (US Eastern)

*Reference Link(s)*

* https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/8/html/configuring_basic_system_settings/index

== Time Synchronization

[cols="^"] 
|===
|
{set:cellbgcolor:#FEFE20}
Changes Recommended
|===

Time Synchronization Status:

[source, bash]
----
No time synchronization service is active.
Chrony service: 
NTP service: 

----

Timedate Control:
[source, bash]
----
           Universal time: Wed 2025-08-06 18:40:38 UTC
                 RTC time: Wed 2025-08-06 18:40:38
                Time zone: Asia/Riyadh (+03, +0300)
System clock synchronized: yes
              NTP service: active
          RTC in local TZ: no

----

**Observation**

Time synchronization is not enabled

**Recommendation**

Install and configure chrony using 'yum install chrony'.

Enable and start the chrony service: 'systemctl enable --now chronyd'.

Enable NTP synchronization: 'timedatectl set-ntp true'.

*Reference Link(s)*

* https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/8/html/configuring_basic_system_settings/index

== Clock Consistency

[cols="^"] 
|===
|
{set:cellbgcolor:#00FF00}
No Change
|===

Clock Information:
[source, bash]
----
System Time: 
Hardware Clock Time: 
RTC in local time: false

----

**Observation**

System clock appears to be consistent

**Recommendation**

None

*Reference Link(s)*

* https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/

== System Hostname

[cols="^"] 
|===
|
{set:cellbgcolor:#00FF00}
No Change
|===

Hostname Information:
[source, bash]
----
Hostname: 
FQDN: 
----

DNS Lookup Result:
[source, bash]
----
127.0.0.1       localhost localhost.localdomain localhost6 localhost6.localdomain6

----

**Observation**

Hostname '' resolves correctly

**Recommendation**

None

*Reference Link(s)*

* https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/

== RHEL Version

[cols="^"] 
|===
|
{set:cellbgcolor:#FEFE20}
Changes Recommended
|===

RHEL Version Information:
[source, bash]
----
RHEL Version: 
Kernel Version: 

----

OS Release Information:
[source, bash]
----
VERSION="9.6 (Plow)"
ID="rhel"
ID_LIKE="fedora"
VERSION_ID="9.6"
PLATFORM_ID="platform:el9"
PRETTY_NAME="Red Hat Enterprise Linux 9.6 (Plow)"
ANSI_COLOR="0;31"
LOGO="fedora-logo-icon"
CPE_NAME="cpe:/o:redhat:enterprise_linux:9::baseos"
HOME_URL="https://www.redhat.com/"
DOCUMENTATION_URL="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9"
BUG_REPORT_URL="https://issues.redhat.com/"

REDHAT_BUGZILLA_PRODUCT="Red Hat Enterprise Linux 9"
REDHAT_BUGZILLA_PRODUCT_VERSION=9.6
REDHAT_SUPPORT_PRODUCT="Red Hat Enterprise Linux"
REDHAT_SUPPORT_PRODUCT_VERSION="9.6"

----

**Observation**

RHEL version could not be verified: 

**Recommendation**

Verify this is a supported Red Hat Enterprise Linux version.

*Reference Link(s)*

* https://access.redhat.com/support/policy/updates/errata

== System Uptime

[cols="^"] 
|===
|
{set:cellbgcolor:#80E5FF}
Advisory
|===

System Uptime Information:
[source, bash]
----
Current Uptime: 
----

Last Reboot Events:
[source, bash]
----
reboot   system boot  5.14.0-570.12.1. Wed Aug  6 09:17 - 09:18  (00:01)
reboot   system boot  5.14.0-570.12.1. Wed Aug  6 09:14 - 09:18  (00:04)

----

**Observation**

System was recently rebooted (less than 1 day ago)

**Recommendation**

Check system logs to verify if the recent reboot was planned or unexpected.

*Reference Link(s)*

* https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/8/html/configuring_basic_system_settings/index

== System Registration

[cols="^"] 
|===
|
{set:cellbgcolor:#00FF00}
No Change
|===

Identity Information:
[source, bash]
----
----

Subscription Status:
[source, bash]
----
   System Status Details
+-------------------------------------------+
Overall Status: Unknown

System Purpose Status: Unknown

----

Consumed Subscriptions:
[source, bash]
----

----

**Observation**

System is properly registered with Red Hat

**Recommendation**

None

*Reference Link(s)*

* https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/

== Enabled Repositories

[cols="^"] 
|===
|
{set:cellbgcolor:#80E5FF}
Advisory
|===

Enabled Repositories:
[source, bash]
----
----

RHEL Version:
[source, bash]
----

----

**Observation**

Could not determine required repositories for this RHEL version

**Recommendation**

Ensure appropriate repositories are enabled for your RHEL version.

*Reference Link(s)*

* https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/

<<<

{set:cellbgcolor!}

# Performance

[cols="1,2,2,3", options=header]
|===
|*Category*
|*Item Evaluated*
|*Observed Result*
|*Recommendation*

// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/cluster-software.item

// Category
|
{set:cellbgcolor!}
Performance

// Item Evaluated
a|
<<Cluster Software>>

| No cluster software detected 

| 
{set:cellbgcolor:#A6B9BF}
Not Applicable

// ------------------------ITEM END
// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/cluster-names.item

// Category
|
{set:cellbgcolor!}
Performance

// Item Evaluated
a|
<<Cluster Name Resolution>>

| System hostname doesn't match any cluster node names 

| 
{set:cellbgcolor:#FEFE20}
Changes Recommended

// ------------------------ITEM END
// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/cluster-fencing.item

// Category
|
{set:cellbgcolor!}
Performance

// Item Evaluated
a|
<<Fencing Agents>>

| No cluster software detected 

| 
{set:cellbgcolor:#A6B9BF}
Not Applicable

// ------------------------ITEM END
// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/cluster-constraints.item

// Category
|
{set:cellbgcolor!}
Performance

// Item Evaluated
a|
<<Cluster Constraints>>

| No cluster software detected 

| 
{set:cellbgcolor:#A6B9BF}
Not Applicable

// ------------------------ITEM END
// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/cluster-autostart.item

// Category
|
{set:cellbgcolor!}
Performance

// Item Evaluated
a|
<<Cluster Autostart>>

| No cluster software detected 

| 
{set:cellbgcolor:#A6B9BF}
Not Applicable

// ------------------------ITEM END
// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/cluster-split-brain.item

// Category
|
{set:cellbgcolor!}
Performance

// Item Evaluated
a|
<<Split-Brain Prevention>>

| No cluster software detected 

| 
{set:cellbgcolor:#A6B9BF}
Not Applicable

// ------------------------ITEM END
// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/cpu-info.item

// Category
|
{set:cellbgcolor!}
Performance

// Item Evaluated
a|
<<CPU Information>>

| System has 2 CPU cores (AMD Ryzen Threadripper PRO 7965WX 24-Cores, Unknown) with normal utilization 

| 
{set:cellbgcolor:#00FF00}
No Change

// ------------------------ITEM END
// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/memory-physical.item

// Category
|
{set:cellbgcolor!}
Performance

// Item Evaluated
a|
<<Physical Memory>>

| Could not determine total physical memory 

| 
{set:cellbgcolor:#FEFE20}
Changes Recommended

// ------------------------ITEM END
// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/tuned-profile.item

// Category
|
{set:cellbgcolor!}
Performance

// Item Evaluated
a|
<<Tuned Profile>>

| No tuned profile is active 

| 
{set:cellbgcolor:#FEFE20}
Changes Recommended

// ------------------------ITEM END
// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/memory-swap.item

// Category
|
{set:cellbgcolor!}
Performance

// Item Evaluated
a|
<<Swap Configuration>>

| Swap space is configured correctly (6.00 GB) 

| 
{set:cellbgcolor:#00FF00}
No Change

// ------------------------ITEM END
// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/cpu-bottlenecks.item

// Category
|
{set:cellbgcolor!}
Performance

// Item Evaluated
a|
<<CPU Bottlenecks>>

| No CPU bottlenecks detected 

| 
{set:cellbgcolor:#00FF00}
No Change

// ------------------------ITEM END
// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/memory-vm-tuning.item

// Category
|
{set:cellbgcolor!}
Performance

// Item Evaluated
a|
<<VM Tuning Parameters>>

| VM tuning parameters are properly configured 

| 
{set:cellbgcolor:#00FF00}
No Change

// ------------------------ITEM END
// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/disk-io-performance.item

// Category
|
{set:cellbgcolor!}
Performance

// Item Evaluated
a|
<<I/O Performance>>

| I/O performance tuning parameters are appropriately configured 

| 
{set:cellbgcolor:#00FF00}
No Change

// ------------------------ITEM END
// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/system-performance.item

// Category
|
{set:cellbgcolor!}
Performance

// Item Evaluated
a|
<<System Performance>>

| System performance metrics are within acceptable ranges 

| 
{set:cellbgcolor:#00FF00}
No Change

// ------------------------ITEM END
// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/performance-bottlenecks.item

// Category
|
{set:cellbgcolor!}
Performance

// Item Evaluated
a|
<<Performance Bottlenecks>>

| No significant performance bottlenecks detected 

| 
{set:cellbgcolor:#00FF00}
No Change

// ------------------------ITEM END
// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/system-caches.item

// Category
|
{set:cellbgcolor!}
Performance

// Item Evaluated
a|
<<System Caches>>

| System cache settings are properly configured 

| 
{set:cellbgcolor:#00FF00}
No Change

// ------------------------ITEM END
|===

== Cluster Software

[cols="^"] 
|===
|
{set:cellbgcolor:#A6B9BF}
Not Applicable
|===

**Observation**

No cluster software detected

**Recommendation**

None

*Reference Link(s)*

* https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/

== Cluster Name Resolution

[cols="^"] 
|===
|
{set:cellbgcolor:#FEFE20}
Changes Recommended
|===

Cluster Nodes from Configuration:
[source, bash]
----
----

System Hostname:
[source, bash]
----
----

**Observation**

System hostname doesn't match any cluster node names

**Recommendation**

Ensure the system hostname matches the name in corosync.conf

Node names should be consistent in all cluster configuration

*Reference Link(s)*

* https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/8/html/configuring_and_managing_high_availability_clusters/assembly_cluster-network-configuring-and-managing-high-availability-clusters

== Fencing Agents

[cols="^"] 
|===
|
{set:cellbgcolor:#A6B9BF}
Not Applicable
|===

**Observation**

No cluster software detected

**Recommendation**

None

*Reference Link(s)*

* https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/

== Cluster Constraints

[cols="^"] 
|===
|
{set:cellbgcolor:#A6B9BF}
Not Applicable
|===

**Observation**

No cluster software detected

**Recommendation**

None

*Reference Link(s)*

* https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/

== Cluster Autostart

[cols="^"] 
|===
|
{set:cellbgcolor:#A6B9BF}
Not Applicable
|===

**Observation**

No cluster software detected

**Recommendation**

None

*Reference Link(s)*

* https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/

== Split-Brain Prevention

[cols="^"] 
|===
|
{set:cellbgcolor:#A6B9BF}
Not Applicable
|===

**Observation**

No cluster software detected

**Recommendation**

None

*Reference Link(s)*

* https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/

== CPU Information

[cols="^"] 
|===
|
{set:cellbgcolor:#00FF00}
No Change
|===

CPU Information:
[source, bash]
----
CPU op-mode(s):                       32-bit, 64-bit
Address sizes:                        52 bits physical, 57 bits virtual
Byte Order:                           Little Endian
CPU(s):                               2
On-line CPU(s) list:                  0,1
Vendor ID:                            AuthenticAMD
BIOS Vendor ID:                       QEMU
Model name:                           AMD Ryzen Threadripper PRO 7965WX 24-Cores
BIOS Model name:                      pc-q35-10.0
CPU family:                           25
Model:                                24
Thread(s) per core:                   1
Core(s) per socket:                   1
Socket(s):                            2
Stepping:                             1
BogoMIPS:                             8387.39
Flags:                                fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush mmx fxsr sse sse2 syscall nx mmxext fxsr_opt pdpe1gb rdtscp lm rep_good nopl cpuid extd_apicid tsc_known_freq pni pclmulqdq ssse3 fma cx16 pcid sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_timer aes xsave avx f16c rdrand hypervisor lahf_lm cmp_legacy svm cr8_legacy abm sse4a misalignsse 3dnowprefetch osvw perfctr_core ssbd perfmon_v2 ibrs ibpb stibp ibrs_enhanced vmmcall fsgsbase tsc_adjust bmi1 avx2 smep bmi2 erms invpcid avx512f avx512dq rdseed adx smap avx512ifma clflushopt clwb avx512cd sha_ni avx512bw avx512vl xsaveopt xsavec xgetbv1 xsaves avx512_bf16 clzero xsaveerptr wbnoinvd arat npt lbrv nrip_save tsc_scale vmcb_clean flushbyasid pausefilter pfthreshold vgif vnmi avx512vbmi umip pku ospke avx512_vbmi2 gfni vaes vpclmulqdq avx512_vnni avx512_bitalg avx512_vpopcntdq la57 rdpid overflow_recov succor fsrm flush_l1d
Virtualization:                       AMD-V
Hypervisor vendor:                    KVM
Virtualization type:                  full
L1d cache:                            128 KiB (2 instances)
L1i cache:                            128 KiB (2 instances)
L2 cache:                             1 MiB (2 instances)
L3 cache:                             32 MiB (2 instances)
NUMA node(s):                         1
NUMA node0 CPU(s):                    0,1
Vulnerability Gather data sampling:   Not affected
Vulnerability Itlb multihit:          Not affected
Vulnerability L1tf:                   Not affected
Vulnerability Mds:                    Not affected
Vulnerability Meltdown:               Not affected
Vulnerability Mmio stale data:        Not affected
Vulnerability Reg file data sampling: Not affected
Vulnerability Retbleed:               Not affected
Vulnerability Spec rstack overflow:   Mitigation; Safe RET
Vulnerability Spec store bypass:      Mitigation; Speculative Store Bypass disabled via prctl
Vulnerability Spectre v1:             Mitigation; usercopy/swapgs barriers and __user pointer sanitization
Vulnerability Spectre v2:             Mitigation; Enhanced / Automatic IBRS; IBPB conditional; STIBP disabled; RSB filling; PBRSB-eIBRS Not affected; BHI Not affected
Vulnerability Srbds:                  Not affected
Vulnerability Tsx async abort:        Not affected

----


CPU Count: 

CPU Utilization:
[source, bash]
----

----


Load Average: 

**Observation**

System has 2 CPU cores (AMD Ryzen Threadripper PRO 7965WX 24-Cores, Unknown) with normal utilization

**Recommendation**

None

*Reference Link(s)*

* https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/

== Physical Memory

[cols="^"] 
|===
|
{set:cellbgcolor:#FEFE20}
Changes Recommended
|===

Memory Information:
[source, bash]
----
Mem:           7.5Gi       518Mi       6.9Gi       0.0Ki       317Mi       7.0Gi
Swap:          6.0Gi          0B       6.0Gi

----


Detailed Memory Information:
[source, bash]
----
MemFree:         7271660 kB
MemAvailable:    7333820 kB
Buffers:            4140 kB
Cached:           246776 kB
SwapCached:            0 kB
Active:           190912 kB
Inactive:         139652 kB
Active(anon):      80396 kB
Inactive(anon):        0 kB
Active(file):     110516 kB
Inactive(file):   139652 kB
Unevictable:           0 kB
Mlocked:               0 kB
SwapTotal:       6291452 kB
SwapFree:        6291452 kB
Zswap:                 0 kB
Zswapped:              0 kB
Dirty:               804 kB
Writeback:             0 kB
AnonPages:         79092 kB
Mapped:            52176 kB
Shmem:               748 kB
KReclaimable:      73852 kB
Slab:             125632 kB
SReclaimable:      73852 kB
SUnreclaim:        51780 kB
KernelStack:        3552 kB
PageTables:         2284 kB
SecPageTables:         0 kB
NFS_Unstable:          0 kB
Bounce:                0 kB
WritebackTmp:          0 kB
CommitLimit:    10223456 kB
Committed_AS:     248548 kB
VmallocTotal:   13743895347199 kB
VmallocUsed:       22936 kB
VmallocChunk:          0 kB
Percpu:              880 kB
HardwareCorrupted:     0 kB
AnonHugePages:     24576 kB
ShmemHugePages:        0 kB
ShmemPmdMapped:        0 kB
FileHugePages:         0 kB
FilePmdMapped:         0 kB
CmaTotal:              0 kB
CmaFree:               0 kB
Unaccepted:            0 kB
HugePages_Total:       0
HugePages_Free:        0
HugePages_Rsvd:        0
HugePages_Surp:        0
Hugepagesize:       2048 kB
Hugetlb:               0 kB
DirectMap4k:      122736 kB
DirectMap2M:     5120000 kB
DirectMap1G:     5242880 kB

----


Memory Usage Over Time:
[source, bash]
----
 r  b   swpd   free   buff  cache   si   so    bi    bo   in   cs us sy id wa st
 0  0      0 7272168   4140 320812    0    0     3     1   20   41  0  0 100  0  0
 0  0      0 7272168   4140 320832    0    0     0     0  189  296  0  0 100  0  0
 0  0      0 7272168   4140 320832    0    0     0     0  171  423  0  0 99  0  0

----

**Observation**

Could not determine total physical memory

**Recommendation**

Check if /proc/meminfo is readable.

*Reference Link(s)*

* https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/

== Tuned Profile

[cols="^"] 
|===
|
{set:cellbgcolor:#FEFE20}
Changes Recommended
|===

Active Tuned Profile: None

Available Profiles:
[source, bash]
----

----

System Type: physical
Server Role: true

**Observation**

No tuned profile is active

**Recommendation**

Activate recommended profile: 'tuned-adm profile throughput-performance'

*Reference Link(s)*

* https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/8/html/monitoring_and_managing_system_status_and_performance/tuned-profiles-distributed-with-rhel_monitoring-and-managing-system-status-and-performance

== Swap Configuration

[cols="^"] 
|===
|
{set:cellbgcolor:#00FF00}
No Change
|===

Swap Information:
[source, bash]
----
Mem:           7.5Gi       543Mi       6.9Gi       0.0Ki       317Mi       7.0Gi
Swap:          6.0Gi          0B       6.0Gi

----


Swap Details:
[source, bash]
----
/dev/dm-1 partition   6G   0B   -2

----


Swap Usage Over Time:
[source, bash]
----
 r  b   swpd   free   buff  cache   si   so    bi    bo   in   cs us sy id wa st
 0  0      0 7254080   4140 321140    0    0     3     1   20   41  0  0 100  0  0
 0  0      0 7254352   4140 321144    0    0     0     4  141  273  0  0 100  0  0
 0  0      0 7255108   4140 321144    0    0     0     0  132  472  0  1 100  0  0

----

**Observation**

Swap space is configured correctly (6.00 GB)

**Recommendation**

None

*Reference Link(s)*

* https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/

== CPU Bottlenecks

[cols="^"] 
|===
|
{set:cellbgcolor:#00FF00}
No Change
|===

Top CPU Consuming Processes:
[source, bash]
----
  26940   26937 sshd: ayaseen@notty          0.3  0.0
   8087    8062 top                          0.1  0.0
      1       0 /usr/lib/systemd/systemd --  0.0  0.2
      2       0 [kthreadd]                   0.0  0.0
      3       2 [pool_workqueue_]            0.0  0.0
      4       2 [kworker/R-rcu_g]            0.0  0.0
      5       2 [kworker/R-sync_]            0.0  0.0
      6       2 [kworker/R-slub_]            0.0  0.0
      7       2 [kworker/R-netns]            0.0  0.0
      9       2 [kworker/0:0H-events_highpr  0.0  0.0

----


CPU Statistics:
[source, bash]
----

----


Interrupt Information:
[source, bash]
----
  1:          0          9   IO-APIC   1-edge      i8042
  8:          2          1   IO-APIC   8-edge      rtc0
  9:          0          0   IO-APIC   9-fasteoi   acpi
 12:         15          0   IO-APIC  12-edge      i8042
 16:          0          0   IO-APIC  16-fasteoi   i801_smbus
 24:          0          0  PCI-MSIX-0000:00:02.0   0-edge      PCIe PME, aerdrv
 25:          0          0  PCI-MSIX-0000:00:02.1   0-edge      PCIe PME, aerdrv
 26:          0          0  PCI-MSIX-0000:00:02.2   0-edge      PCIe PME, aerdrv
 27:          0          0  PCI-MSIX-0000:00:02.3   0-edge      PCIe PME, aerdrv
 28:          0          0  PCI-MSIX-0000:00:02.4   0-edge      PCIe PME, aerdrv
 29:          0          0  PCI-MSIX-0000:00:02.5   0-edge      PCIe PME, aerdrv
 30:          0          0  PCI-MSIX-0000:00:02.6   0-edge      PCIe PME, aerdrv
 31:          0          0  PCI-MSIX-0000:00:02.7   0-edge      PCIe PME, aerdrv
 32:          0          0  PCI-MSIX-0000:00:03.0   0-edge      PCIe PME, aerdrv
 33:          0          0  PCI-MSIX-0000:00:03.1   0-edge      PCIe PME, aerdrv
 34:          0          0  PCI-MSIX-0000:00:03.2   0-edge      PCIe PME, aerdrv
 35:          0          0  PCI-MSIX-0000:00:03.3   0-edge      PCIe PME, aerdrv
 36:          0          0  PCI-MSIX-0000:00:03.4   0-edge      PCIe PME, aerdrv
 37:          0          0  PCI-MSIX-0000:00:03.5   0-edge      PCIe PME, aerdrv

----

**Observation**

No CPU bottlenecks detected

**Recommendation**

None

*Reference Link(s)*

* https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/

== VM Tuning Parameters

[cols="^"] 
|===
|
{set:cellbgcolor:#00FF00}
No Change
|===

VM Tuning Parameters:
[source, bash]
----
VM Swappiness: 
Dirty Ratio: N/A
Dirty Background Ratio: N/A
VFS Cache Pressure: N/A
Transparent Hugepages: 

----

Sysctl Configuration:
[source, bash]
----

----

**Observation**

VM tuning parameters are properly configured

**Recommendation**

None

*Reference Link(s)*

* https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/

== I/O Performance

[cols="^"] 
|===
|
{set:cellbgcolor:#00FF00}
No Change
|===

Block Device Information:
[source, bash]
----
sr0                    11.9G rom  
vda                      60G disk 
├─vda1                    1G part /boot
└─vda2                   59G part 
  ├─rhel-root          30.6G lvm  /
  ├─rhel-swap             6G lvm  [SWAP]
  ├─rhel-var_tmp        1.9G lvm  /var/tmp
  ├─rhel-tmp            1.9G lvm  /tmp
  ├─rhel-var_log        4.7G lvm  /var/log
  ├─rhel-var_log_audit  4.7G lvm  /var/log/audit
  ├─rhel-var            4.3G lvm  /var
  └─rhel-home             5G lvm  /home

----

I/O Scheduler Settings:
/dev/vda scheduler: , readahead:  KB


I/O Statistics:
[source, bash]
----

----

**Observation**

I/O performance tuning parameters are appropriately configured

**Recommendation**

None

*Reference Link(s)*

* https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/

== System Performance

[cols="^"] 
|===
|
{set:cellbgcolor:#00FF00}
No Change
|===

System Uptime and Load:
[source, bash]
----

----


VMStat Output:
[source, bash]
----
 r  b   swpd   free   buff  cache   si   so    bi    bo   in   cs us sy id wa st
 0  0      0 7271332   4040 324072    0    0     3     2   21   43  0  0 100  0  0
 0  0      0 7271584   4040 324076    0    0     0    16  142  233  0  0 100  0  0
 0  0      0 7271836   4040 324076    0    0     0     0  132  458  0  0 100  0  0

----


Memory Usage:
[source, bash]
----
Mem:           7.5Gi       517Mi       6.9Gi       0.0Ki       320Mi       7.0Gi
Swap:          6.0Gi          0B       6.0Gi

----


Disk I/O Statistics:
[source, bash]
----

----


Network Statistics:
[source, bash]
----

----

**Observation**

System performance metrics are within acceptable ranges

**Recommendation**

None

*Reference Link(s)*

* https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/

== Performance Bottlenecks

[cols="^"] 
|===
|
{set:cellbgcolor:#00FF00}
No Change
|===

Top Memory Consuming Processes:
[source, bash]
----
    822       1 /usr/bin/python3 -s /usr/sb  0.5
    832       1 /usr/sbin/NetworkManager --  0.2
    624       1 /usr/lib/systemd/systemd-jo  0.2
    925       1 /usr/sbin/rsyslogd -n        0.2
      1       0 /usr/lib/systemd/systemd --  0.2
   8052       1 /usr/lib/systemd/systemd --  0.1
    635       1 /usr/lib/systemd/systemd-ud  0.1
  26937     865 sshd: ayaseen [priv]         0.1
   8048     865 sshd: ayaseen [priv]         0.1
    825       1 /usr/lib/systemd/systemd-lo  0.1

----

Top CPU Consuming Processes:
[source, bash]
----
  26940 sshd: ayaseen@notty          0.3
   8087 top                          0.1
      1 /usr/lib/systemd/systemd --  0.0
      2 [kthreadd]                   0.0
      3 [pool_workqueue_]            0.0
      4 [kworker/R-rcu_g]            0.0
      5 [kworker/R-sync_]            0.0
      6 [kworker/R-slub_]            0.0
      7 [kworker/R-netns]            0.0
      9 [kworker/0:0H-events_highpr  0.0

----

Largest Directories:
[source, bash]
----
688M	/usr/lib
539M	/usr/lib/firmware
323M	/usr/share
156M	/usr/lib64
121M	/var
109M	/usr/share/locale
96M	/usr/lib/modules
71M	/var/lib
66M	/usr/share/openscap
66M	/usr/bin
50M	/var/log
48M	/usr/lib64/python3.9
47M	/usr/sbin
44M	/var/lib/rpm
33M	/var/log/journal
25M	/usr/share/xml
19M	/usr/share/doc
19M	/usr/lib/python3.9
18M	/var/lib/selinux

----

Swap Usage (MB):
[source, bash]
----

----

Zombie Processes Count:
[source, bash]
----

----

Process Count vs Ulimit:
[source, bash]
----

----

Open File Descriptors Count vs Limit:
[source, bash]
----

----

{set:cellbgcolor!}
Performance Metrics Summary:

|===
|Metric|Value|Status

|Memory Process Usage|Normal|OK
|CPU Process Usage|Normal|OK
|Swap Usage|0 MB|OK
|Zombie Processes|0|OK
|Systemd Services|All operational|OK
|Process Count|0 / 1 (0.0%)|OK
|File Descriptors|0 / 1 (0.0%)|OK
|===

**Observation**

No significant performance bottlenecks detected

**Recommendation**

None

*Reference Link(s)*

* https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/

== System Caches

[cols="^"] 
|===
|
{set:cellbgcolor:#00FF00}
No Change
|===

Memory Cache Information:
[source, bash]
----
SwapCached:            0 kB

----


Cache-related Kernel Parameters:
[source, bash]
----
vm.dirty_background_ratio = 10
vm.dirty_bytes = 0
vm.dirty_expire_centisecs = 3000
vm.dirty_ratio = 20
vm.dirty_writeback_centisecs = 500
vm.dirtytime_expire_seconds = 43200
vm.swappiness = 60
vm.vfs_cache_pressure = 100

----


Dirty Pages Status:
[source, bash]
----
nr_writeback 0
nr_writeback_temp 0
nr_dirty_threshold 369298
nr_dirty_background_threshold 184423

----


Kernel Slab Cache Details:
[source, bash]
----
 Active / Total Slabs (% used)      : 15560 / 15560 (100.0%)
 Active / Total Caches (% used)     : 159 / 262 (60.7%)
 Active / Total Size (% used)       : 112051.43K / 113295.38K (98.9%)
 Minimum / Average / Maximum Object : 0.01K / 0.19K / 8.81K

  OBJS ACTIVE  USE OBJ SIZE  SLABS OBJ/SLAB CACHE SIZE NAME                   
 35160  35160 100%    1.06K   2344       15     37504K xfs_inode              
 25356  25324  99%    0.66K   2113       12     16904K inode_cache            
 70875  70691  99%    0.19K   3375       21     13500K dentry                 
 65576  65511  99%    0.07K   1171       56      4684K lsm_inode_cache        
 27456  27456 100%    0.12K    858       32      3432K kernfs_node_cache      
 51840  51749  99%    0.06K    810       64      3240K kmalloc-64             
   752    731  97%    4.00K     94        8      3008K kmalloc-4k             
 44288  44288 100%    0.06K    692       64      2768K ebitmap_node           
  3652   3596  98%    0.73K    166       22      2656K proc_inode_cache       
   237    227  95%    8.81K     79        3      2528K task_struct            
 91120  91120 100%    0.02K    536      170      2144K avtab_node             
  3500   3500 100%    0.57K    250       14      2000K radix_tree_node        
  1440   1363  94%    1.00K     90       16      1440K kmalloc-1k             

----

Dirty Pages Information:
[source, bash]
----
Current dirty pages: 369298
Current dirty pages: 184423

----

**Observation**

System cache settings are properly configured

**Recommendation**

None

*Reference Link(s)*

* https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/

<<<

{set:cellbgcolor!}

# Storage

[cols="1,2,2,3", options=header]
|===
|*Category*
|*Item Evaluated*
|*Observed Result*
|*Recommendation*

// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/disk-usage.item

// Category
|
{set:cellbgcolor!}
Storage

// Item Evaluated
a|
<<Disk Usage>>

| All filesystems have acceptable disk usage levels 

| 
{set:cellbgcolor:#00FF00}
No Change

// ------------------------ITEM END
// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/disk-mount-points.item

// Category
|
{set:cellbgcolor!}
Storage

// Item Evaluated
a|
<<Mount Points>>

| Some mount points could be optimized with better options 

| 
{set:cellbgcolor:#80E5FF}
Advisory

// ------------------------ITEM END
// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/storage-multipath.item

// Category
|
{set:cellbgcolor!}
Storage

// Item Evaluated
a|
<<Multipath Configuration>>

| Multipath is not installed 

| 
{set:cellbgcolor:#A6B9BF}
Not Applicable

// ------------------------ITEM END
// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/storage-config.item

// Category
|
{set:cellbgcolor!}
Storage

// Item Evaluated
a|
<<Storage Configuration>>

| Storage is properly configured with LVM 

| 
{set:cellbgcolor:#00FF00}
No Change

// ------------------------ITEM END
// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/storage-filesystem-types.item

// Category
|
{set:cellbgcolor!}
Storage

// Item Evaluated
a|
<<Filesystem Types>>

| Using recommended filesystem types: xfs (8) 

| 
{set:cellbgcolor:#00FF00}
No Change

// ------------------------ITEM END
// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/storage-considerations-performance.item

// Category
|
{set:cellbgcolor!}
Storage

// Item Evaluated
a|
<<Storage Performance>>

| Storage performance settings appear to be appropriate 

| 
{set:cellbgcolor:#00FF00}
No Change

// ------------------------ITEM END
// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/storage-filesystem-errors.item

// Category
|
{set:cellbgcolor!}
Storage

// Item Evaluated
a|
<<Filesystem Errors>>

| Filesystem errors detected 

| 
{set:cellbgcolor:#FF0000}
Changes Required

// ------------------------ITEM END
// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/storage-considerations-reliability.item

// Category
|
{set:cellbgcolor!}
Storage

// Item Evaluated
a|
<<Storage Reliability>>

| Virtual machine - storage redundancy managed by hypervisor 

| 
{set:cellbgcolor:#00FF00}
No Change

// ------------------------ITEM END
// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/storage-considerations-capacity.item

// Category
|
{set:cellbgcolor!}
Storage

// Item Evaluated
a|
<<Storage Capacity>>

| Storage capacity appears to be adequate 

| 
{set:cellbgcolor:#00FF00}
No Change

// ------------------------ITEM END
// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/storage-partition-alignment.item

// Category
|
{set:cellbgcolor!}
Storage

// Item Evaluated
a|
<<Partition Alignment>>

| All partitions appear to be properly aligned 

| 
{set:cellbgcolor:#00FF00}
No Change

// ------------------------ITEM END
|===

== Disk Usage

[cols="^"] 
|===
|
{set:cellbgcolor:#00FF00}
No Change
|===

Filesystem Disk Usage:
[source, bash]
----
devtmpfs  4.0M  0  4.0M  0%  /dev
tmpfs  3.8G    0    3.8G    0%    /dev/shm
tmpfs  1.5G    748K    1.5G    1%    /run
/dev/mapper/rhel-root  31G    1.6G    29G    6%    /
/dev/vda1  960M    242M    719M    26%    /boot
/dev/mapper/rhel-home  5.0G    68M    4.9G    2%    /home
/dev/mapper/rhel-tmp  1.9G    46M    1.8G    3%    /tmp
/dev/mapper/rhel-var  4.3G    133M    4.2G    4%    /var
/dev/mapper/rhel-var_log  4.6G    107M    4.5G    3%    /var/log
/dev/mapper/rhel-var_tmp  1.9G    46M    1.8G    3%    /var/tmp
/dev/mapper/rhel-var_log_audit  4.6G    70M    4.6G    2%    /var/log/audit
tmpfs  768M    0    768M    0%    /run/user/1000

----

Filesystem Inode Usage:
[source, bash]
----
devtmpfs  977303  433  976870  1%  /dev
tmpfs  983001    1    983000    1%    /dev/shm
tmpfs  819200    704    818496    1%    /run
/dev/mapper/rhel-root  16050176    32902    16017274    1%    /
/dev/vda1  524288    360    523928    1%    /boot
/dev/mapper/rhel-home  2621440    14    2621426    1%    /home
/dev/mapper/rhel-tmp  976896    23    976873    1%    /tmp
/dev/mapper/rhel-var  2273280    2107    2271173    1%    /var
/dev/mapper/rhel-var_log  2443264    52    2443212    1%    /var/log
/dev/mapper/rhel-var_tmp  976896    25    976871    1%    /var/tmp
/dev/mapper/rhel-var_log_audit  2443264    4    2443260    1%    /var/log/audit
tmpfs  196600    14    196586    1%    /run/user/1000

----

Largest Files (>100MB):
[source, bash]
----
No files larger than 100MB found or command timed out.

----

**Observation**

All filesystems have acceptable disk usage levels

**Recommendation**

None

*Reference Link(s)*

* https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/

== Mount Points

[cols="^"] 
|===
|
{set:cellbgcolor:#80E5FF}
Advisory
|===

Current Mount Information:
[source, bash]
----
sysfs on /sys type sysfs (rw,nosuid,nodev,noexec,relatime,seclabel)
devtmpfs on /dev type devtmpfs (rw,nosuid,seclabel,size=4096k,nr_inodes=977303,mode=755,inode64)
securityfs on /sys/kernel/security type securityfs (rw,nosuid,nodev,noexec,relatime)
tmpfs on /dev/shm type tmpfs (rw,nosuid,nodev,noexec,relatime,seclabel,inode64)
devpts on /dev/pts type devpts (rw,nosuid,noexec,relatime,seclabel,gid=5,mode=620,ptmxmode=000)
tmpfs on /run type tmpfs (rw,nosuid,nodev,seclabel,size=1572804k,nr_inodes=819200,mode=755,inode64)
cgroup2 on /sys/fs/cgroup type cgroup2 (rw,nosuid,nodev,noexec,relatime,seclabel,nsdelegate,memory_recursiveprot)
pstore on /sys/fs/pstore type pstore (rw,nosuid,nodev,noexec,relatime,seclabel)
bpf on /sys/fs/bpf type bpf (rw,nosuid,nodev,noexec,relatime,mode=700)
/dev/mapper/rhel-root on / type xfs (rw,relatime,seclabel,attr2,inode64,logbufs=8,logbsize=32k,noquota)
selinuxfs on /sys/fs/selinux type selinuxfs (rw,nosuid,noexec,relatime)
systemd-1 on /proc/sys/fs/binfmt_misc type autofs (rw,relatime,fd=29,pgrp=1,timeout=0,minproto=5,maxproto=5,direct,pipe_ino=15338)
mqueue on /dev/mqueue type mqueue (rw,nosuid,nodev,noexec,relatime,seclabel)
hugetlbfs on /dev/hugepages type hugetlbfs (rw,relatime,seclabel,pagesize=2M)
debugfs on /sys/kernel/debug type debugfs (rw,nosuid,nodev,noexec,relatime,seclabel)
tracefs on /sys/kernel/tracing type tracefs (rw,nosuid,nodev,noexec,relatime,seclabel)
none on /run/credentials/systemd-sysctl.service type ramfs (ro,nosuid,nodev,noexec,relatime,seclabel,mode=700)
configfs on /sys/kernel/config type configfs (rw,nosuid,nodev,noexec,relatime)
none on /run/credentials/systemd-tmpfiles-setup-dev.service type ramfs (ro,nosuid,nodev,noexec,relatime,seclabel,mode=700)
fusectl on /sys/fs/fuse/connections type fusectl (rw,nosuid,nodev,noexec,relatime)
/dev/vda1 on /boot type xfs (rw,relatime,seclabel,attr2,inode64,logbufs=8,logbsize=32k,noquota)
/dev/mapper/rhel-home on /home type xfs (rw,nosuid,nodev,relatime,seclabel,attr2,inode64,logbufs=8,logbsize=32k,noquota)
/dev/mapper/rhel-tmp on /tmp type xfs (rw,nosuid,nodev,noexec,relatime,seclabel,attr2,inode64,logbufs=8,logbsize=32k,noquota)
/dev/mapper/rhel-var on /var type xfs (rw,nosuid,nodev,relatime,seclabel,attr2,inode64,logbufs=8,logbsize=32k,noquota)
/dev/mapper/rhel-var_log on /var/log type xfs (rw,nosuid,nodev,noexec,relatime,seclabel,attr2,inode64,logbufs=8,logbsize=32k,noquota)
/dev/mapper/rhel-var_tmp on /var/tmp type xfs (rw,nosuid,nodev,noexec,relatime,seclabel,attr2,inode64,logbufs=8,logbsize=32k,noquota)
/dev/mapper/rhel-var_log_audit on /var/log/audit type xfs (rw,nosuid,nodev,noexec,relatime,seclabel,attr2,inode64,logbufs=8,logbsize=32k,noquota)
none on /run/credentials/systemd-tmpfiles-setup.service type ramfs (ro,nosuid,nodev,noexec,relatime,seclabel,mode=700)
binfmt_misc on /proc/sys/fs/binfmt_misc type binfmt_misc (rw,nosuid,nodev,noexec,relatime)
tmpfs on /run/user/1000 type tmpfs (rw,nosuid,nodev,relatime,seclabel,size=786400k,nr_inodes=196600,mode=700,uid=1000,gid=1000,inode64)

----

Mount Points in fstab:
[source, bash]
----
/dev/mapper/rhel-root   /                       xfs     defaults        0 0
UUID=8add4ebd-d928-4cd5-a194-5434f93d3a87 /boot                   xfs     defaults        0 0
/dev/mapper/rhel-home   /home                   xfs     defaults,nodev,nosuid 0 0
/dev/mapper/rhel-tmp    /tmp                    xfs     defaults,nodev,noexec,nosuid 0 0
/dev/mapper/rhel-var    /var                    xfs     defaults,nodev,nosuid 0 0
/dev/mapper/rhel-var_log /var/log                xfs     defaults,nodev,noexec,nosuid 0 0
/dev/mapper/rhel-var_log_audit /var/log/audit          xfs     defaults,nodev,noexec,nosuid 0 0
/dev/mapper/rhel-var_tmp /var/tmp                xfs     defaults,nodev,noexec,nosuid 0 0
/dev/mapper/rhel-swap   none                    swap    defaults        0 0
tmpfs /dev/shm tmpfs defaults,relatime,inode64,nodev,noexec,nosuid 0 0

----


Mount Points Without noatime Option:
[source, bash]
----
/dev/vda1 on /boot type xfs (rw,relatime,seclabel,attr2,inode64,logbufs=8,logbsize=32k,noquota)
/dev/mapper/rhel-home on /home type xfs (rw,nosuid,nodev,relatime,seclabel,attr2,inode64,logbufs=8,logbsize=32k,noquota)
/dev/mapper/rhel-tmp on /tmp type xfs (rw,nosuid,nodev,noexec,relatime,seclabel,attr2,inode64,logbufs=8,logbsize=32k,noquota)
/dev/mapper/rhel-var on /var type xfs (rw,nosuid,nodev,relatime,seclabel,attr2,inode64,logbufs=8,logbsize=32k,noquota)
/dev/mapper/rhel-var_log on /var/log type xfs (rw,nosuid,nodev,noexec,relatime,seclabel,attr2,inode64,logbufs=8,logbsize=32k,noquota)
/dev/mapper/rhel-var_tmp on /var/tmp type xfs (rw,nosuid,nodev,noexec,relatime,seclabel,attr2,inode64,logbufs=8,logbsize=32k,noquota)
/dev/mapper/rhel-var_log_audit on /var/log/audit type xfs (rw,nosuid,nodev,noexec,relatime,seclabel,attr2,inode64,logbufs=8,logbsize=32k,noquota)

----

**Observation**

Some mount points could be optimized with better options

**Recommendation**

Consider adding 'noatime' mount option to improve performance

Edit /etc/fstab and add 'noatime' to the options field (4th column)

*Reference Link(s)*

* https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/8/#Storage

== Multipath Configuration

[cols="^"] 
|===
|
{set:cellbgcolor:#A6B9BF}
Not Applicable
|===

**Observation**

Multipath is not installed

**Recommendation**

This check is not applicable as device-mapper-multipath is not installed

*Reference Link(s)*

* https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/

== Storage Configuration

[cols="^"] 
|===
|
{set:cellbgcolor:#00FF00}
No Change
|===

LVM Configuration:


Logical Volumes:


[source, bash]
----
  home          rhel -wi-ao----  5.00g                                                    
  root          rhel -wi-ao---- 30.61g                                                    
  swap          rhel -wi-ao----  6.00g                                                    
  tmp           rhel -wi-ao----  1.86g                                                    
  var           rhel -wi-ao---- <4.34g                                                    
  var_log       rhel -wi-ao----  4.66g                                                    
  var_log_audit rhel -wi-ao----  4.66g                                                    
  var_tmp       rhel -wi-ao----  1.86g                                                    

----

Volume Groups:


[source, bash]
----
  rhel   1   8   0 wz--n- <59.00g    0 

----

Physical Volumes:


[source, bash]
----
  /dev/vda2  rhel lvm2 a--  <59.00g    0 

----


RAID Configuration:

[source, bash]
----

No software RAID configured

----

Multipath Configuration:

[source, bash]
----

Multipath not configured or not installed

----

**Observation**

Storage is properly configured with LVM

**Recommendation**

None

*Reference Link(s)*

* https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/

== Filesystem Types

[cols="^"] 
|===
|
{set:cellbgcolor:#00FF00}
No Change
|===

Filesystems in Use:
[source, bash]
----
/dev/mapper/rhel-root          xfs       32034816 1642700  30392116   6% /
/dev/vda1                      xfs         983040  246940    736100  26% /boot
/dev/mapper/rhel-home          xfs        5177344   69268   5108076   2% /home
/dev/mapper/rhel-tmp           xfs        1888256   46308   1841948   3% /tmp
/dev/mapper/rhel-var           xfs        4481024  135440   4345584   4% /var
/dev/mapper/rhel-var_log       xfs        4820992  109820   4711172   3% /var/log
/dev/mapper/rhel-var_tmp       xfs        1888256   46328   1841928   3% /var/tmp
/dev/mapper/rhel-var_log_audit xfs        4820992   72680   4748312   2% /var/log/audit

----

Mounted Filesystems:
[source, bash]
----
pstore on /sys/fs/pstore type pstore (rw,nosuid,nodev,noexec,relatime,seclabel)
bpf on /sys/fs/bpf type bpf (rw,nosuid,nodev,noexec,relatime,mode=700)
/dev/mapper/rhel-root on / type xfs (rw,relatime,seclabel,attr2,inode64,logbufs=8,logbsize=32k,noquota)
selinuxfs on /sys/fs/selinux type selinuxfs (rw,nosuid,noexec,relatime)
mqueue on /dev/mqueue type mqueue (rw,nosuid,nodev,noexec,relatime,seclabel)
hugetlbfs on /dev/hugepages type hugetlbfs (rw,relatime,seclabel,pagesize=2M)
debugfs on /sys/kernel/debug type debugfs (rw,nosuid,nodev,noexec,relatime,seclabel)
tracefs on /sys/kernel/tracing type tracefs (rw,nosuid,nodev,noexec,relatime,seclabel)
none on /run/credentials/systemd-sysctl.service type ramfs (ro,nosuid,nodev,noexec,relatime,seclabel,mode=700)
configfs on /sys/kernel/config type configfs (rw,nosuid,nodev,noexec,relatime)
none on /run/credentials/systemd-tmpfiles-setup-dev.service type ramfs (ro,nosuid,nodev,noexec,relatime,seclabel,mode=700)
fusectl on /sys/fs/fuse/connections type fusectl (rw,nosuid,nodev,noexec,relatime)
/dev/vda1 on /boot type xfs (rw,relatime,seclabel,attr2,inode64,logbufs=8,logbsize=32k,noquota)
/dev/mapper/rhel-home on /home type xfs (rw,nosuid,nodev,relatime,seclabel,attr2,inode64,logbufs=8,logbsize=32k,noquota)
/dev/mapper/rhel-tmp on /tmp type xfs (rw,nosuid,nodev,noexec,relatime,seclabel,attr2,inode64,logbufs=8,logbsize=32k,noquota)
/dev/mapper/rhel-var on /var type xfs (rw,nosuid,nodev,relatime,seclabel,attr2,inode64,logbufs=8,logbsize=32k,noquota)
/dev/mapper/rhel-var_log on /var/log type xfs (rw,nosuid,nodev,noexec,relatime,seclabel,attr2,inode64,logbufs=8,logbsize=32k,noquota)
/dev/mapper/rhel-var_tmp on /var/tmp type xfs (rw,nosuid,nodev,noexec,relatime,seclabel,attr2,inode64,logbufs=8,logbsize=32k,noquota)
/dev/mapper/rhel-var_log_audit on /var/log/audit type xfs (rw,nosuid,nodev,noexec,relatime,seclabel,attr2,inode64,logbufs=8,logbsize=32k,noquota)
none on /run/credentials/systemd-tmpfiles-setup.service type ramfs (ro,nosuid,nodev,noexec,relatime,seclabel,mode=700)

----

Kernel-Supported Filesystems:
[source, bash]
----
	fuseblk

----

Filesystem Configuration in /etc/fstab:
[source, bash]
----
/dev/mapper/rhel-root   /                       xfs     defaults        0 0
UUID=8add4ebd-d928-4cd5-a194-5434f93d3a87 /boot                   xfs     defaults        0 0
/dev/mapper/rhel-home   /home                   xfs     defaults,nodev,nosuid 0 0
/dev/mapper/rhel-tmp    /tmp                    xfs     defaults,nodev,noexec,nosuid 0 0
/dev/mapper/rhel-var    /var                    xfs     defaults,nodev,nosuid 0 0
/dev/mapper/rhel-var_log /var/log                xfs     defaults,nodev,noexec,nosuid 0 0
/dev/mapper/rhel-var_log_audit /var/log/audit          xfs     defaults,nodev,noexec,nosuid 0 0
/dev/mapper/rhel-var_tmp /var/tmp                xfs     defaults,nodev,noexec,nosuid 0 0
/dev/mapper/rhel-swap   none                    swap    defaults        0 0
tmpfs /dev/shm tmpfs defaults,relatime,inode64,nodev,noexec,nosuid 0 0

----

**Observation**

Using recommended filesystem types: xfs (8)

**Recommendation**

None

*Reference Link(s)*

* https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/

== Storage Performance

[cols="^"] 
|===
|
{set:cellbgcolor:#00FF00}
No Change
|===

I/O Scheduler Settings:
[source, bash]
----

----

Disk Readahead Settings:
[source, bash]
----

----

Disk Types:
[source, bash]
----

----

Disk NUMA Assignments:
[source, bash]
----

----

I/O Statistics:
[source, bash]
----

----

**Observation**

Storage performance settings appear to be appropriate

**Recommendation**

None

*Reference Link(s)*

* https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/

== Filesystem Errors

[cols="^"] 
|===
|
{set:cellbgcolor:#FF0000}
Changes Required
|===

No filesystem errors found in kernel log

No filesystem errors found in journal

Filesystem Check Configuration in fstab:
[source, bash]
----
No explicit fsck configuration found

----

Filesystems Mounted Read-Only (possible error state):
[source, bash]
----
none on /run/credentials/systemd-tmpfiles-setup-dev.service type ramfs (ro,nosuid,nodev,noexec,relatime,seclabel,mode=700)
none on /run/credentials/systemd-tmpfiles-setup.service type ramfs (ro,nosuid,nodev,noexec,relatime,seclabel,mode=700)

----

Root Filesystem Space Usage:
[source, bash]
----
/dev/mapper/rhel-root   31G  1.6G   29G   6% /

----

**Observation**

Filesystem errors detected

**Recommendation**

Filesystem remounted read-only due to errors - recovery needed

Run filesystem check on affected filesystems

Check for disk hardware issues with 'smartctl -a /dev/sdX'

*Reference Link(s)*

* https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/8/html/managing_storage_devices/file-system-checks-managing-storage-devices

== Storage Reliability

[cols="^"] 
|===
|
{set:cellbgcolor:#00FF00}
No Change
|===

Software RAID Status:
[source, bash]
----
unused devices: <none>

----

Hardware RAID Controller:
[source, bash]
----

----

LVM Configuration:
[source, bash]
----
  home          rhel -wi-ao----  5.00g                                                    
  root          rhel -wi-ao---- 30.61g                                                    
  swap          rhel -wi-ao----  6.00g                                                    
  tmp           rhel -wi-ao----  1.86g                                                    
  var           rhel -wi-ao---- <4.34g                                                    
  var_log       rhel -wi-ao----  4.66g                                                    
  var_log_audit rhel -wi-ao----  4.66g                                                    
  var_tmp       rhel -wi-ao----  1.86g                                                    

----

Multipath Configuration:
[source, bash]
----

----

Disk Health Status:
[source, bash]
----
Virtual machine - SMART data not applicable
----

**Observation**

Virtual machine - storage redundancy managed by hypervisor

**Recommendation**

None

*Reference Link(s)*

* https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/

== Storage Capacity

[cols="^"] 
|===
|
{set:cellbgcolor:#00FF00}
No Change
|===

Filesystem Disk Usage:
[source, bash]
----
devtmpfs                       devtmpfs  4.0M     0  4.0M   0% /dev
tmpfs                          tmpfs     3.8G     0  3.8G   0% /dev/shm
tmpfs                          tmpfs     1.5G  760K  1.5G   1% /run
/dev/mapper/rhel-root          xfs        31G  1.6G   29G   6% /
/dev/vda1                      xfs       960M  242M  719M  26% /boot
/dev/mapper/rhel-home          xfs       5.0G   68M  4.9G   2% /home
/dev/mapper/rhel-tmp           xfs       1.9G   46M  1.8G   3% /tmp
/dev/mapper/rhel-var           xfs       4.3G  133M  4.2G   4% /var
/dev/mapper/rhel-var_log       xfs       4.6G  108M  4.5G   3% /var/log
/dev/mapper/rhel-var_tmp       xfs       1.9G   46M  1.8G   3% /var/tmp
/dev/mapper/rhel-var_log_audit xfs       4.6G   71M  4.6G   2% /var/log/audit
tmpfs                          tmpfs     768M     0  768M   0% /run/user/1000

----

Filesystem Inode Usage:
[source, bash]
----
/dev/mapper/rhel-root          xfs      16050176 32902 16017274    1% /
/dev/vda1                      xfs        524288   360   523928    1% /boot
/dev/mapper/rhel-home          xfs       2621440    14  2621426    1% /home
/dev/mapper/rhel-tmp           xfs        976896    19   976877    1% /tmp
/dev/mapper/rhel-var           xfs       2273280  2107  2271173    1% /var
/dev/mapper/rhel-var_log       xfs       2443264    52  2443212    1% /var/log
/dev/mapper/rhel-var_tmp       xfs        976896    21   976875    1% /var/tmp
/dev/mapper/rhel-var_log_audit xfs       2443264     4  2443260    1% /var/log/audit

----

Disk Usage Trend:
[source, bash]
----
Filesystem                      Size  Used Avail Use% Mounted on
/dev/mapper/rhel-root            31G  1.6G   29G   6% /
/dev/vda1                       960M  242M  719M  26% /boot
/dev/mapper/rhel-home           5.0G   68M  4.9G   2% /home
/dev/mapper/rhel-tmp            1.9G   46M  1.8G   3% /tmp
/dev/mapper/rhel-var            4.3G  133M  4.2G   4% /var
/dev/mapper/rhel-var_log        4.6G  108M  4.5G   3% /var/log
/dev/mapper/rhel-var_tmp        1.9G   46M  1.8G   3% /var/tmp
/dev/mapper/rhel-var_log_audit  4.6G   71M  4.6G   2% /var/log/audit
Wed Aug  6 09:42:25 PM +03 2025
Filesystem                      Size  Used Avail Use% Mounted on
/dev/mapper/rhel-root            31G  1.6G   29G   6% /
/dev/vda1                       960M  242M  719M  26% /boot
/dev/mapper/rhel-home           5.0G   68M  4.9G   2% /home
/dev/mapper/rhel-tmp            1.9G   46M  1.8G   3% /tmp
/dev/mapper/rhel-var            4.3G  133M  4.2G   4% /var
/dev/mapper/rhel-var_log        4.6G  108M  4.5G   3% /var/log
/dev/mapper/rhel-var_tmp        1.9G   46M  1.8G   3% /var/tmp
/dev/mapper/rhel-var_log_audit  4.6G   71M  4.6G   2% /var/log/audit
Wed Aug  6 09:42:26 PM +03 2025
Filesystem                      Size  Used Avail Use% Mounted on
/dev/mapper/rhel-root            31G  1.6G   29G   6% /
/dev/vda1                       960M  242M  719M  26% /boot
/dev/mapper/rhel-home           5.0G   68M  4.9G   2% /home
/dev/mapper/rhel-tmp            1.9G   46M  1.8G   3% /tmp
/dev/mapper/rhel-var            4.3G  133M  4.2G   4% /var
/dev/mapper/rhel-var_log        4.6G  108M  4.5G   3% /var/log
/dev/mapper/rhel-var_tmp        1.9G   46M  1.8G   3% /var/tmp
/dev/mapper/rhel-var_log_audit  4.6G   71M  4.6G   2% /var/log/audit

----

Historical Capacity Alerts:
[source, bash]
----

----

**Observation**

Storage capacity appears to be adequate

**Recommendation**

None

*Reference Link(s)*

* https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/

== Partition Alignment

[cols="^"] 
|===
|
{set:cellbgcolor:#00FF00}
No Change
|===

Partition Information:
[source, bash]
----
Disk /dev/sr0: 12.8GB
Sector size (logical/physical): 2048B/2048B
Partition Table: msdos
Disk Flags: 

Number  Start   End     Size    Type     File system  Flags
 2      9511kB  38.7MB  29.2MB  primary               esp


Model: Virtio Block Device (virtblk)
Disk /dev/vda: 64.4GB
Sector size (logical/physical): 512B/512B
Partition Table: msdos
Disk Flags: 

Number  Start   End     Size    Type     File system  Flags
 1      1049kB  1075MB  1074MB  primary  xfs          boot
 2      1075MB  64.4GB  63.3GB  primary               lvm



----

Partition Alignment Details:
[source, bash]
----
Disk: /dev/vda
/dev/vda1  *       2048   2099199   2097152   1G 83 Linux
/dev/vda2       2099200 125829119 123729920  59G 8e Linux LVM

----

Disk Parameters (optimal_io_size physical_block_size alignment_offset):
[source, bash]
----
Disk: /dev/vda
0 512 0 

----

Disk Types:
[source, bash]
----

----

Mount Points:
[source, bash]
----
/sys
/dev
/sys/kernel/security
/dev/shm
/dev/pts
/run
/sys/fs/cgroup
/sys/fs/pstore
/sys/fs/bpf
/
/sys/fs/selinux
/proc/sys/fs/binfmt_misc
/dev/mqueue
/dev/hugepages
/sys/kernel/debug
/sys/kernel/tracing
/run/credentials/systemd-sysctl.service
/sys/kernel/config
/run/credentials/systemd-tmpfiles-setup-dev.service
/sys/fs/fuse/connections
/boot
/home
/tmp
/var
/var/log
/var/tmp
/var/log/audit
/run/credentials/systemd-tmpfiles-setup.service
/proc/sys/fs/binfmt_misc
/run/user/1000

----

LUKS Encryption Status:
[source, bash]
----
No LUKS encrypted devices detected

----

System Type:
[source, bash]
----
Virtual Machine: 

----

**Observation**

All partitions appear to be properly aligned

**Recommendation**

Consider implementing LUKS encryption for security-sensitive data

*Reference Link(s)*

* https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/

<<<

{set:cellbgcolor!}

# Security

[cols="1,2,2,3", options=header]
|===
|*Category*
|*Item Evaluated*
|*Observed Result*
|*Recommendation*

// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/kernel-version.item

// Category
|
{set:cellbgcolor!}
Security

// Item Evaluated
a|
<<Kernel Version>>

| Repository metadata is 20306 days old - unable to reliably determine if latest kernel is installed 

| 
{set:cellbgcolor:#FEFE20}
Changes Recommended

// ------------------------ITEM END
// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/kernel-firmware.item

// Category
|
{set:cellbgcolor!}
Security

// Item Evaluated
a|
<<BIOS/UEFI Firmware>>

| This is a virtual machine - firmware is managed by the hypervisor 

| 
{set:cellbgcolor:#80E5FF}
Advisory

// ------------------------ITEM END
// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/security-selinux.item

// Category
|
{set:cellbgcolor!}
Security

// Item Evaluated
a|
<<SELinux Status>>

| SELinux is properly configured and enforcing 

| 
{set:cellbgcolor:#00FF00}
No Change

// ------------------------ITEM END
// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/security-auditd.item

// Category
|
{set:cellbgcolor!}
Security

// Item Evaluated
a|
<<Audit Configuration>>

| Found 3 issues with audit configuration 

| 
{set:cellbgcolor:#FEFE20}
Changes Recommended

// ------------------------ITEM END
// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/kernel-unused-devices.item

// Category
|
{set:cellbgcolor!}
Security

// Item Evaluated
a|
<<Unused Devices>>

| This is a virtual machine - device management is handled by the hypervisor 

| 
{set:cellbgcolor:#A6B9BF}
Not Applicable

// ------------------------ITEM END
// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/security-password-policy.item

// Category
|
{set:cellbgcolor!}
Security

// Item Evaluated
a|
<<Password Policy>>

| Found 3 password policy issues 

| 
{set:cellbgcolor:#FEFE20}
Changes Recommended

// ------------------------ITEM END
// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/compliance-rhel-cis.item

// Category
|
{set:cellbgcolor!}
Security

// Item Evaluated
a|
<<RHEL CIS Compliance>>

| System has low compliance with RHEL CIS standards (35%) 

| 
{set:cellbgcolor:#FF0000}
Changes Required

// ------------------------ITEM END
// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/security-file-permissions.item

// Category
|
{set:cellbgcolor!}
Security

// Item Evaluated
a|
<<File Permissions>>

| Found 3 file permission issues 

| 
{set:cellbgcolor:#FEFE20}
Changes Recommended

// ------------------------ITEM END
// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/security-ssh-hardening.item

// Category
|
{set:cellbgcolor!}
Security

// Item Evaluated
a|
<<SSH Hardening>>

| Found 13 SSH hardening issues 

| 
{set:cellbgcolor:#FEFE20}
Changes Recommended

// ------------------------ITEM END
// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/security-root-account.item

// Category
|
{set:cellbgcolor!}
Security

// Item Evaluated
a|
<<Root Account Security>>

| Found 2 root account security issues 

| 
{set:cellbgcolor:#FEFE20}
Changes Recommended

// ------------------------ITEM END
// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/auth-central.item

// Category
|
{set:cellbgcolor!}
Security

// Item Evaluated
a|
<<Central Authentication>>

| No central authentication configuration detected 

| 
{set:cellbgcolor:#FF0000}
Changes Required

// ------------------------ITEM END
// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/security-shell-history.item

// Category
|
{set:cellbgcolor!}
Security

// Item Evaluated
a|
<<Shell History Configuration>>

| Found 2 shell history configuration issues 

| 
{set:cellbgcolor:#FEFE20}
Changes Recommended

// ------------------------ITEM END
// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/auth-sssd.item

// Category
|
{set:cellbgcolor!}
Security

// Item Evaluated
a|
<<SSSD Configuration>>

| SSSD is not installed 

| 
{set:cellbgcolor:#80E5FF}
Advisory

// ------------------------ITEM END
// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/auth-sudo-pam.item

// Category
|
{set:cellbgcolor!}
Security

// Item Evaluated
a|
<<Sudo and PAM>>

| Local users with root or sudo privileges detected 

| 
{set:cellbgcolor:#FF0000}
Changes Required

// ------------------------ITEM END
// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/auth-kerberos.item

// Category
|
{set:cellbgcolor!}
Security

// Item Evaluated
a|
<<Kerberos Configuration>>

| Kerberos is not configured on this system 

| 
{set:cellbgcolor:#A6B9BF}
Not Applicable

// ------------------------ITEM END
|===

== Kernel Version

[cols="^"] 
|===
|
{set:cellbgcolor:#FEFE20}
Changes Recommended
|===

Current Running Kernel:
[source, bash]
----

----

Latest Available Kernel:
[source, bash]
----

----

Repository Metadata Status:
[source, bash]
----
Could not determine repository metadata age

----

Kernel Version Status Summary:
[source, text]
----
Running kernel: 
Latest available kernel: 
Formatted for comparison: 
Repository metadata age: 20306 days
Running latest kernel: true

----

**Observation**

Repository metadata is 20306 days old - unable to reliably determine if latest kernel is installed

**Recommendation**

Refresh repository metadata with 'subscription-manager refresh'

For disconnected environments, sync content from Satellite server

*Reference Link(s)*

* https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/8/html/configuring_basic_system_settingsindex

== BIOS/UEFI Firmware

[cols="^"] 
|===
|
{set:cellbgcolor:#80E5FF}
Advisory
|===

System Information:
[source, bash]
----
System Manufacturer: QEMU
System Model: Standard PC (Q35 + ICH9, 2009)
Firmware Vendor: SeaBIOS
Firmware Version: Arch Linux 1.17.0-1-1
Firmware Date: 04/01/2014
System Type: 

----

Firmware Information:
[source, bash]
----
Getting SMBIOS data from sysfs.
SMBIOS 2.8 present.

Handle 0x0000, DMI type 0, 24 bytes
BIOS Information
	Vendor: SeaBIOS
	Version: Arch Linux 1.17.0-1-1
	Release Date: 04/01/2014
	Address: 0xE8000
	Runtime Size: 96 kB
	ROM Size: 64 kB
	Characteristics:
		BIOS characteristics not supported
		Targeted content distribution is supported
	BIOS Revision: 0.0


----

System Information:
[source, bash]
----
Getting SMBIOS data from sysfs.
SMBIOS 2.8 present.

Handle 0x0100, DMI type 1, 27 bytes
System Information
	Manufacturer: QEMU
	Product Name: Standard PC (Q35 + ICH9, 2009)
	Version: pc-q35-10.0
	Serial Number: Not Specified
	UUID: c7811417-736d-4065-9dfc-9b6333fd2437
	Wake-up Type: Power Switch
	SKU Number: Not Specified
	Family: Not Specified

Handle 0x2000, DMI type 32, 11 bytes
System Boot Information
	Status: No errors detected


----

Intel MDS Vulnerability Status:
[source, bash]
----

----

**Observation**

This is a virtual machine - firmware is managed by the hypervisor

**Recommendation**

Ensure the hypervisor host's firmware is up to date

*Reference Link(s)*

* https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/8/#Virtualization

== SELinux Status

[cols="^"] 
|===
|
{set:cellbgcolor:#00FF00}
No Change
|===

SELinux Status:
[source, bash]
----
SELinuxfs mount:                /sys/fs/selinux
SELinux root directory:         /etc/selinux
Loaded policy name:             targeted
Current mode:                   enforcing
Mode from config file:          enforcing
Policy MLS status:              enabled
Policy deny_unknown status:     allowed
Memory protection checking:     actual (secure)
Max kernel policy version:      33

----

SELinux Mode:
[source, bash]
----

----

SELinux Configuration:
[source, bash]
----
# NOTE: Up to RHEL 8 release included, SELINUX=disabled would also
SELINUX=enforcing

----

AVC Denials Count:
[source, bash]
----

----

**Observation**

SELinux is properly configured and enforcing

**Recommendation**

None

*Reference Link(s)*

* https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/

== Audit Configuration

[cols="^"] 
|===
|
{set:cellbgcolor:#FEFE20}
Changes Recommended
|===

Auditd Service Active: false

Audit Configuration:
[source, bash]
----
max_log_file = 8
num_logs = 5
max_log_file_action = ROTATE
space_left = 75
space_left_action = SYSLOG
action_mail_acct = root
admin_space_left = 50
admin_space_left_action = SUSPEND
disk_full_action = SUSPEND
disk_error_action = SUSPEND
overflow_action = SYSLOG

----

Audit Rules:
[source, bash]
----

----

Audit Log File:
[source, bash]
----

----

TTY Auditing Configuration:
[source, bash]
----

----

**Observation**

Found 3 issues with audit configuration

**Recommendation**

Audit daemon (auditd) is not active

Few audit rules defined (0 rules)

TTY auditing not configured for root user

Install and enable auditd: 'yum install audit && systemctl enable --now auditd'

Configure audit rules in /etc/audit/rules.d/

Follow security guidelines for critical events to audit

Enable TTY auditing for root in /etc/pam.d/system-auth and password-auth: 'session required pam_tty_audit.so enable=root'

*Reference Link(s)*

* https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/8/html/security_hardening/configuring-auditd_security-hardening

== Unused Devices

[cols="^"] 
|===
|
{set:cellbgcolor:#A6B9BF}
Not Applicable
|===

Device Status:
[source, bash]
----
- fingerprint: Loaded
- firewire: Loaded
- sound: Loaded
- smartcard: Loaded
- bluetooth: Loaded
- thunderbolt: Loaded
- wireless: Loaded
- webcam: Loaded

----

Kernel Module Blacklisting:
[source, bash]
----
# Disable per security requirements
install cramfs /bin/false
blacklist cramfs

# Disable per security requirements
install freevxfs /bin/false
blacklist freevxfs

# Disable per security requirements
install hfs /bin/false
blacklist hfs

# Disable per security requirements
install hfsplus /bin/false
blacklist hfsplus

# Disable per security requirements
install jffs2 /bin/false
blacklist jffs2

# Disable per security requirements
install usb-storage /bin/false
blacklist usb-storage

----

Kernel Boot Parameters for Blacklisting:
[source, bash]
----

----

PCI Devices and Drivers:
[source, bash]
----
	Subsystem: Red Hat, Inc. QEMU Virtual Machine
00:01.0 VGA compatible controller: Device 1234:1111 (rev 02)
	Subsystem: Red Hat, Inc. Device 1100
	Kernel driver in use: bochs-drm
	Kernel modules: bochs
00:02.0 PCI bridge: Red Hat, Inc. QEMU PCIe Root port
	Kernel driver in use: pcieport
00:02.1 PCI bridge: Red Hat, Inc. QEMU PCIe Root port
	Kernel driver in use: pcieport
00:02.2 PCI bridge: Red Hat, Inc. QEMU PCIe Root port
	Kernel driver in use: pcieport
00:02.3 PCI bridge: Red Hat, Inc. QEMU PCIe Root port
	Kernel driver in use: pcieport
00:02.4 PCI bridge: Red Hat, Inc. QEMU PCIe Root port
	Kernel driver in use: pcieport
00:02.5 PCI bridge: Red Hat, Inc. QEMU PCIe Root port
	Kernel driver in use: pcieport
00:02.6 PCI bridge: Red Hat, Inc. QEMU PCIe Root port
	Kernel driver in use: pcieport
00:02.7 PCI bridge: Red Hat, Inc. QEMU PCIe Root port
... (output truncated)

----

**Observation**

This is a virtual machine - device management is handled by the hypervisor

**Recommendation**

None

*Reference Link(s)*

* https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/

== Password Policy

[cols="^"] 
|===
|
{set:cellbgcolor:#FEFE20}
Changes Recommended
|===

Password Quality Configuration:
[source, bash]
----
# Defaults:
#
# Number of characters in the new password that must not be present in the
# old password.
# difok = 1
#
# Minimum acceptable size for the new password (plus one if
# credits are not disabled which is the default). (See pam_cracklib manual.)
# Cannot be set to lower value than 6.
# minlen = 8
#
# The maximum credit for having digits in the new password. If less than 0
# it is the minimum number of digits in the new password.
# dcredit = 0
#
# The maximum credit for having uppercase characters in the new password.
# If less than 0 it is the minimum number of uppercase characters in the new
# password.
# ucredit = 0
#
# The maximum credit for having lowercase characters in the new password.
# If less than 0 it is the minimum number of lowercase characters in the new
# password.
# lcredit = 0
#
# The maximum credit for having other characters in the new password.
# If less than 0 it is the minimum number of other characters in the new
# password.
# ocredit = 0
#
# The minimum number of required classes of characters for the new
# password (digits, uppercase, lowercase, others).
# minclass = 0
#
# The maximum number of allowed consecutive same characters in the new password.
# The check is disabled if the value is 0.
# maxrepeat = 0
#
# The maximum number of allowed consecutive characters of the same class in the
# new password.
# The check is disabled if the value is 0.
# maxclassrepeat = 0
#
# Whether to check for the words from the passwd entry GECOS string of the user.
# The check is enabled if the value is not 0.
# gecoscheck = 0
#
# Whether to check for the words from the cracklib dictionary.
# The check is enabled if the value is not 0.
# dictcheck = 1
#
# Whether to check if it contains the user name in some form.
# The check is enabled if the value is not 0.
# usercheck = 1
#
# Length of substrings from the username to check for in the password
# The check is enabled if the value is greater than 0 and usercheck is enabled.
# usersubstr = 0
#
# Whether the check is enforced by the PAM module and possibly other
# applications.
# The new password is rejected if it fails the check and the value is not 0.
# enforcing = 1
#
# Path to the cracklib dictionaries. Default is to use the cracklib default.
# dictpath =
#
# Prompt user at most N times before returning with error. The default is 1.
# retry = 3
#
# Enforces pwquality checks on the root user password.
# Enabled if the option is present.
# enforce_for_root
#
# Skip testing the password quality for users that are not present in the
# /etc/passwd file.
# Enabled if the option is present.
# local_users_only
# Per CCE-88413-0: Set dictcheck = 1 in /etc/security/pwquality.conf
dictcheck = 1
# Per CCE-83564-5: Set difok = 2 in /etc/security/pwquality.conf
difok = 2
enforce_for_root
# Per CCE-83567-8: Set maxrepeat = 3 in /etc/security/pwquality.conf
maxrepeat = 3
# Per CCE-83563-7: Set minclass = 4 in /etc/security/pwquality.conf
minclass = 4
# Per CCE-83579-3: Set minlen = 14 in /etc/security/pwquality.conf
minlen = 14

----

Password Aging Policy:
[source, bash]
----
#	PASS_MIN_DAYS	Minimum number of days allowed between password changes.
#	PASS_MIN_LEN	Minimum acceptable password length.
#	PASS_WARN_AGE	Number of days warning given before a password expires.
PASS_MAX_DAYS 365
PASS_MIN_DAYS	0
PASS_WARN_AGE	7
# Currently PASS_MIN_LEN is not supported

----

Account Lockout Policy:
[source, bash]
----
auth        required                                     pam_faillock.so authfail
account     required                                     pam_faillock.so

----

Sudo Access Rules:
[source, bash]
----
Defaults    always_set_home
Defaults    match_group_by_gid
Defaults    always_query_group_plugin
Defaults    env_reset
Defaults    env_keep =  "COLORS DISPLAY HOSTNAME HISTSIZE KDEDIR LS_COLORS"
Defaults    env_keep += "MAIL PS1 PS2 QTDIR USERNAME LANG LC_ADDRESS LC_CTYPE"
Defaults    env_keep += "LC_COLLATE LC_IDENTIFICATION LC_MEASUREMENT LC_MESSAGES"
Defaults    env_keep += "LC_MONETARY LC_NAME LC_NUMERIC LC_PAPER LC_TELEPHONE"
Defaults    env_keep += "LC_TIME LC_ALL LANGUAGE LINGUAS _XKB_CHARSET XAUTHORITY"
Defaults    secure_path = /sbin:/bin:/usr/sbin:/usr/bin
root	ALL=(ALL) 	ALL
%wheel	ALL=(ALL)	ALL
Defaults use_pty
Defaults logfile=/var/log/sudo.log
Defaults timestamp_timeout=5

----

Sudo Logging Configuration:
[source, bash]
----
Sudo logging not configured

----

Password Hashing Algorithm:
[source, bash]
----

----

**Observation**

Found 3 password policy issues

**Recommendation**

Password maximum age (365 days) exceeds 90 days

Sudo command logging not configured

Secure password hashing (SHA-512) not configured

Add 'Defaults logfile=/var/log/sudo.log' to /etc/sudoers

*Reference Link(s)*

* https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/8/html/security_hardening/using-tools-and-services-to-enhance-security_security-hardening#configuring-password-security_using-tools-and-services-to-enhance-security

== RHEL CIS Compliance

[cols="^"] 
|===
|
{set:cellbgcolor:#FF0000}
Changes Required
|===

RHEL CIS Compliance and Best Practices Report

Overall Score: 35/100 (35%)

{set:cellbgcolor!}
Category Scores:
[cols="2,1,1,1", options="header"]
|===
|Category|Score|Max Score|Percentage
|Partitioning|8|10|80%
|Filesystem Configuration|8|10|80%
|Authentication|2|10|20%
|Network Security|0|10|0%
|Services|4|10|40%
|SELinux & MAC|0|10|0%
|System Updates|7|10|70%
|Logging & Auditing|0|10|0%
|Time Synchronization|0|10|0%
|Additional Security|6|10|60%
|===


== Detailed Findings:

=== Partitioning (8/10)
* ✗ /home is NOT on a separate partition
* ✓ /tmp is on a separate partition
* ✓ /var is on a separate partition
* ✓ /var/log is on a separate partition
* ✓ /var/tmp is on a separate partition

Recommendations:
* Create a separate partition for /home

=== Filesystem Configuration (8/10)
* ✓ /tmp has nodev option
* ✓ /tmp has nosuid option
* ✓ /tmp has noexec option
* ✓ /var/tmp has nodev option
* ✓ /var/tmp has nosuid option
* ✓ /var/tmp has noexec option
* ✗ /home lacks nodev option

Recommendations:
* Add nodev option to /home mount

=== Authentication (2/10)
* ✗ SSSD is not installed
* ✗ System is not joined to Red Hat IDM or Active Directory
* ✓ PAM has password quality requirements

Recommendations:
* Install SSSD: 'yum install sssd'
* Join system to Red Hat IDM or Active Directory

=== Network Security (0/10)
* ✗ Firewall (firewalld) is not active
* ✗ SSH root login is not explicitly disabled
* ✗ SSH password authentication is not disabled

Recommendations:
* Enable firewalld: 'systemctl enable --now firewalld'
* Disable SSH root login: 'PermitRootLogin no'
* Disable SSH password auth: 'PasswordAuthentication no'

=== Services (4/10)
* ✓ 0/11 unnecessary services are disabled or not installed
* ✓ Low number of enabled services: 0

=== SELinux & MAC (0/10)
* ✗ SELinux is disabled
* ✗ SELinux policy is not set to targeted

Recommendations:
* Enable SELinux in enforcing mode
* Set SELinux policy to targeted

=== System Updates (7/10)
* ✓ No security updates pending
* ✗ Automatic updates are not configured

Recommendations:
* Install automatic updates: 'yum install yum-cron' or 'yum install dnf-automatic'

=== Logging & Auditing (0/10)
* ✗ rsyslog service is not active
* ✗ auditd service is not active
* ✗ Log rotation may not be properly configured

Recommendations:
* Enable rsyslog: 'systemctl enable --now rsyslog'
* Enable auditd: 'systemctl enable --now auditd'
* Review and configure log rotation settings

=== Time Synchronization (0/10)
* ✗ No time synchronization service is active
* ✗ Timezone not properly configured

Recommendations:
* Enable chronyd: 'systemctl enable --now chronyd'
* Set timezone with timedatectl

=== Additional Security (6/10)
* ✓ AIDE (file integrity) is installed
* ✓ Account lockout after failed logins is configured
* ✗ GRUB boot password is not configured
* ✓ USB storage is disabled by policy

Recommendations:
* Configure GRUB password protection

**Observation**

System has low compliance with RHEL CIS standards (35%)

**Recommendation**

Create a separate partition for /home

Add nodev option to /home mount

Install SSSD: 'yum install sssd'

Join system to Red Hat IDM or Active Directory

Enable firewalld: 'systemctl enable --now firewalld'

... and 11 more recommendations (see details)

*Reference Link(s)*

* https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/8/html/security_hardening/index

== File Permissions

[cols="^"] 
|===
|
{set:cellbgcolor:#FEFE20}
Changes Recommended
|===

File Permissions for Sensitive Files:
[source, bash]
----
-rw-r--r--. 1 root root    528 Aug  6 09:12 /etc/group
----------. 1 root root    415 Aug  6 09:12 /etc/gshadow
-rw-r--r--. 1 root root   1035 Aug  6 09:11 /etc/passwd
----------. 1 root root    780 Aug  6 09:17 /etc/shadow
-rw-------. 1 root root   4243 Aug  6 09:12 /etc/ssh/sshd_config
-r--r-----. 1 root root   4409 Aug  6 09:12 /etc/sudoers
-rw-rw----. 1 root utmp   1920 Aug  6 18:18 /var/log/btmp
-rw-rw-r--. 1 root utmp 292292 Aug  6 19:02 /var/log/lastlog
-rw-rw-r--. 1 root utmp  23424 Aug  6 19:02 /var/log/wtmp

----

No world-writable files found in key directories.

World-Readable Log Files Found:
[source, bash]
----
      136     16 -rw-rw-r--   1 root     utmp       292292 Aug  6 19:02 /var/log/lastlog
  8519810      4 -rw-r--r--   1 root     root         1919 Aug  6 20:32 /var/log/rhsm/rhsmcertd.log
  8519811      4 -rw-r--r--   1 root     root          821 Aug  6 20:32 /var/log/rhsm/rhsm.log
      157     32 -rw-r--r--   1 root     root        28841 Aug  6 09:12 /var/log/anaconda/lorax-packages.log
      161     48 -rw-r--r--   1 root     root        48162 Aug  6 21:41 /var/log/dnf.log
      162      8 -rw-r--r--   1 root     root         6960 Aug  6 21:41 /var/log/dnf.librepo.log
      163      4 -rw-r--r--   1 root     root         1740 Aug  6 21:41 /var/log/dnf.rpm.log

----

Cron Directory Permissions:
[source, bash]
----

----

Immutable Critical Files:
[source, bash]
----

----

SELinux Contexts for Critical Files:
[source, bash]
----
     system_u:object_r:shadow_t:s0 /etc/shadow
        system_u:object_r:etc_t:s0 /etc/ssh/sshd_config

----

Audit Rules for Critical Files:
[source, bash]
----

----

SCAP Security Tools Installation:
[source, bash]
----
scap-security-guide-0.1.76-1.el9.noarch
openscap-scanner-1.3.11-1.el9.x86_64
----

Unapproved SUID/SGID Binaries Found (whitelist approach):
[source, bash]
----
/usr/sbin/grub2-set-bootflag
/usr/sbin/pam_timestamp_check

----

**Observation**

Found 3 file permission issues

**Recommendation**

World-readable log files found in /var/log

/etc/cron.d directory has incorrect permissions (should be 700)

Unapproved SUID/SGID binaries found (not in whitelist)

Remove world-readable permissions from log files: 'chmod o-r /var/log/*'

Fix /etc/cron.d directory permissions: 'chmod 700 /etc/cron.d'

Review and remove SUID/SGID from unapproved binaries: 'chmod -s <file>'

Maintain a whitelist of allowed SUID/SGID binaries per Red Hat recommendations

*Reference Link(s)*

* https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/8/html/security_hardening/assembly_securing-files-and-directories_security-hardening

== SSH Hardening

[cols="^"] 
|===
|
{set:cellbgcolor:#FEFE20}
Changes Recommended
|===

SSH Configuration File Content:
[source, bash]
----
#	$OpenBSD: sshd_config,v 1.104 2021/07/02 05:11:21 dtucker Exp $

# This is the sshd server system-wide configuration file.  See
# sshd_config(5) for more information.

# This sshd was compiled with PATH=/usr/local/bin:/usr/bin:/usr/local/sbin:/usr/sbin

# The strategy used for options in the default sshd_config shipped with
# OpenSSH is to specify options with their default value where
# possible, but leave them commented.  Uncommented options override the
# default value.

# To modify the system-wide sshd configuration, create a  *.conf  file under
#  /etc/ssh/sshd_config.d/  which will be automatically included below
Include /etc/ssh/sshd_config.d/*.conf

# If you want to change the port on a SELinux system, you have to tell
# SELinux about this change.
# semanage port -a -t ssh_port_t -p tcp #PORTNUMBER
#
... (output truncated) ...

----

SSH Server Configuration Highlights:
[source, bash]
----
Protocol: 
Root Login: 
Empty Passwords: 
X11 Forwarding: 
Max Auth Tries: 
Password Authentication: 
Challenge Response Auth: 
Login Grace Time: 
Client Alive Interval: 
Client Alive Count Max: 
Hostbased Authentication: 
TCP Forwarding: 
Banner: 
Allow Users/Groups: 
UseDNS: 
Ciphers: 
MACs: 
Key Exchange Algorithms: 

----

SSH Configuration File Permissions:
[source, bash]
----
sshd_config: 

----

SSH Host Key File Permissions:
[source, bash]
----
/etc/ssh/ssh_host_rsa_key 640 root:ssh_keys
/etc/ssh/ssh_host_ed25519_key 640 root:ssh_keys


----

PAM SSH Configuration:
[source, bash]
----
auth       substack     password-auth
auth       include      postlogin
account    required     pam_sepermit.so
account    required     pam_nologin.so
account    include      password-auth
password   include      password-auth
# pam_selinux.so close should be the first session rule
session    required     pam_selinux.so close
session    required     pam_loginuid.so
# pam_selinux.so open should only be followed by sessions to be executed in the user context
session    required     pam_selinux.so open env_params
session    required     pam_namespace.so
session    optional     pam_keyinit.so force revoke
session    optional     pam_motd.so
session    include      password-auth
session    include      postlogin

----

**Observation**

Found 13 SSH hardening issues

**Recommendation**

SSH MaxAuthTries is set to 6 (recommended max: 4)

LoginGraceTime is 120 seconds (recommended: 60s or less)

ClientAliveInterval is 0 (recommended: 300s or less, but not 0)

HostbasedAuthentication is not explicitly disabled

TCP forwarding is not explicitly disabled

UseDNS is not set to 'no' (can cause connection delays)

SSH config file has incorrect permissions or ownership (should be 600 or 644, owned by root)

SSH host key /etc/ssh/ssh_host_rsa_key has incorrect permissions: 640 (should be 600)

SSH host key /etc/ssh/ssh_host_rsa_key has incorrect ownership: root:ssh_keys (should be root:root)

SSH host key /etc/ssh/ssh_host_ed25519_key has incorrect permissions: 640 (should be 600)

SSH host key /etc/ssh/ssh_host_ed25519_key has incorrect ownership: root:ssh_keys (should be root:root)

PAM faillock not configured for SSH (account lockout protection missing)

PAM password quality not configured for SSH (password complexity checks missing)

Edit /etc/ssh/sshd_config and set recommended values:

- Protocol 2

- PermitRootLogin no

- PermitEmptyPasswords no

- X11Forwarding no

- MaxAuthTries 4

- PasswordAuthentication no (if key-based auth is set up)

- ChallengeResponseAuthentication no

- LoginGraceTime 60

- ClientAliveInterval 300

- ClientAliveCountMax 3

- HostbasedAuthentication no

- AllowTcpForwarding no

- Banner /etc/issue.net

- UseDNS no

Configure AllowUsers or AllowGroups to restrict SSH access

Ensure SSH configuration files have appropriate permissions (chmod 600 /etc/ssh/sshd_config)

Restart SSH after changes: 'systemctl restart sshd'

*Reference Link(s)*

* https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/8/html/security_hardening/assembly_securing-the-openssh-service_security-hardening

== Root Account Security

[cols="^"] 
|===
|
{set:cellbgcolor:#FEFE20}
Changes Recommended
|===

Root Account Security Analysis:

Root Login Shell:
[source, bash]
----


----

Securetty Configuration (terminals allowed for root login):
[source, bash]
----

----

Wheel Group Configuration in Sudoers:
[source, bash]
----
None

----

Root Idle Timeout Configuration:
[source, bash]
----

----

GRUB Password Protection:
[source, bash]
----
GRUB password configured

----

Members of Wheel Group:
[source, bash]
----

----

TTY Auditing for SU Command:
[source, bash]
----

----

**Observation**

Found 2 root account security issues

**Recommendation**

Root account has a valid login shell

Wheel group not properly configured in sudoers

Change the root shell to /sbin/nologin in /etc/passwd to prevent direct logins

Configure wheel group in /etc/sudoers: '%wheel ALL=(ALL) ALL'

*Reference Link(s)*

* https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/8/html/security_hardening/configuring-automated-password-security_security-hardening

== Central Authentication

[cols="^"] 
|===
|
{set:cellbgcolor:#FF0000}
Changes Required
|===

SSSD Installation:
[source, bash]
----
SSSD not installed

----

Realm Membership:
[source, bash]
----

----

Authentication Configuration:
[source, bash]
----
Enabled features:
- with-faillock
- with-pwhistory
- without-nullok

----

Kerberos Configuration Excerpt:
[source, bash]
----
[logging]
    default = FILE:/var/log/krb5libs.log
    kdc = FILE:/var/log/krb5kdc.log
    admin_server = FILE:/var/log/kadmind.log
[libdefaults]
    dns_lookup_realm = false
    ticket_lifetime = 24h
    renew_lifetime = 7d
    forwardable = true
    rdns = false
    pkinit_anchors = FILE:/etc/pki/tls/certs/ca-bundle.crt
    spake_preauth_groups = edwards25519
    dns_canonicalize_hostname = fallback
    qualify_shortname = ""
    default_ccache_name = KEYRING:persistent:%{uid}
[realms]
[domain_realm]

----

LDAP Configuration Excerpt:
[source, bash]
----

----

Non-Local Users (first 5):
[source, bash]
----
grep: daemon:2: No such file or directory
grep: adm:3: No such file or directory
grep: lp:4: No such file or directory
grep: sync:5: No such file or directory
grep: shutdown:6: No such file or directory
grep: halt:7: No such file or directory
grep: mail:8: No such file or directory
grep: operator:11: No such file or directory
grep: games:12: No such file or directory
grep: ftp:14: No such file or directory
grep: nobody:65534: No such file or directory
grep: systemd-coredump:999: No such file or directory
grep: dbus:81: No such file or directory
grep: tss:59: No such file or directory
grep: sssd:998: No such file or directory
grep: systemd-journal-remote:997: No such file or directory
grep: sshd:74: No such file or directory
grep: chrony:996: No such file or directory
grep: ayaseen:1000: No such file or directory

----

**Observation**

No central authentication configuration detected

**Recommendation**

Consider implementing central authentication for easier user management

Options include FreeIPA, Active Directory, or LDAP

*Reference Link(s)*

* https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/8/html/configuring_authentication_and_authorization_in_rhel/index

== Shell History Configuration

[cols="^"] 
|===
|
{set:cellbgcolor:#FEFE20}
Changes Recommended
|===

Shell History Configuration Analysis:

Global Bash History Settings:
[source, bash]
----
/etc/bashrc:            PROMPT_COMMAND=/etc/sysconfig/bash-prompt-xterm
/etc/bashrc:            PROMPT_COMMAND='printf "\033]0;%s@%s:%s\007" "${USER}" "${HOSTNAME%%.*}" "${PWD/#$HOME/\~}"'
/etc/bashrc:            PROMPT_COMMAND=/etc/sysconfig/bash-prompt-screen
/etc/bashrc:            PROMPT_COMMAND='printf "\033k%s@%s:%s\033\\" "${USER}" "${HOSTNAME%%.*}" "${PWD/#$HOME/\~}"'
/etc/bashrc:        [ -e /etc/sysconfig/bash-prompt-default ] && PROMPT_COMMAND=/etc/sysconfig/bash-prompt-default
/etc/bashrc:    shopt -s histappend
/etc/profile:HISTSIZE=1000
/etc/profile:export PATH USER LOGNAME MAIL HOSTNAME HISTSIZE HISTCONTROL

----

Root Bash History File Attributes:
[source, bash]
----

----

History Size Settings:
[source, bash]
----
/etc/profile:HISTSIZE=1000

----

History Timestamp Configuration:
[source, bash]
----

----

History Append Configuration:
[source, bash]
----

----

PROMPT_COMMAND History Configuration:
[source, bash]
----

----

Command Logging to Syslog:
[source, bash]
----

----

**Observation**

Found 2 shell history configuration issues

**Recommendation**

HISTFILESIZE is not set or too small (should be at least 10000)

Root's bash_history file is not set as append-only

Set appropriate history sizes in /etc/profile.d/history.sh:

export HISTSIZE=10000

export HISTFILESIZE=20000

Make root's history append-only: 'chattr +a /root/.bash_history'

*Reference Link(s)*

* https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/8/html/security_hardening/assembly_securing-the-system-against-intrusion_security-hardening

== SSSD Configuration

[cols="^"] 
|===
|
{set:cellbgcolor:#80E5FF}
Advisory
|===

**Observation**

SSSD is not installed

**Recommendation**

Consider installing SSSD for improved authentication capabilities

*Reference Link(s)*

* https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/8/html/configuring_authentication_and_authorization_in_rhel/index

== Sudo and PAM

[cols="^"] 
|===
|
{set:cellbgcolor:#FF0000}
Changes Required
|===

Sudo Rules:
[source, bash]
----
Defaults    always_set_home
Defaults    match_group_by_gid
Defaults    always_query_group_plugin
Defaults    env_reset
Defaults    env_keep =  "COLORS DISPLAY HOSTNAME HISTSIZE KDEDIR LS_COLORS"
Defaults    env_keep += "MAIL PS1 PS2 QTDIR USERNAME LANG LC_ADDRESS LC_CTYPE"
Defaults    env_keep += "LC_COLLATE LC_IDENTIFICATION LC_MEASUREMENT LC_MESSAGES"
Defaults    env_keep += "LC_MONETARY LC_NAME LC_NUMERIC LC_PAPER LC_TELEPHONE"
Defaults    env_keep += "LC_TIME LC_ALL LANGUAGE LINGUAS _XKB_CHARSET XAUTHORITY"
Defaults    secure_path = /sbin:/bin:/usr/sbin:/usr/bin
root	ALL=(ALL) 	ALL
%wheel	ALL=(ALL)	ALL
Defaults use_pty
Defaults logfile=/var/log/sudo.log
Defaults timestamp_timeout=5

----

LDAP Sudo Configuration:
[source, bash]
----

----

PAM System Auth Configuration:
[source, bash]
----
auth        required                                     pam_env.so
auth        required                                     pam_faildelay.so delay=2000000
auth        required                                     pam_faillock.so preauth silent
auth        [default=1 ignore=ignore success=ok]         pam_usertype.so isregular
auth        [default=1 ignore=ignore success=ok]         pam_localuser.so
auth        sufficient                                   pam_unix.so
auth        [default=1 ignore=ignore success=ok]         pam_usertype.so isregular
auth        sufficient                                   pam_sss.so forward_pass
auth        required                                     pam_faillock.so authfail
auth        required                                     pam_deny.so

account     required                                     pam_faillock.so
account     required                                     pam_unix.so
account     sufficient                                   pam_localuser.so
account     sufficient                                   pam_usertype.so issystem
account     [default=bad success=ok user_unknown=ignore] pam_sss.so
account     required                                     pam_permit.so

password    requisite                                    pam_pwquality.so local_users_only
password    [default=1 ignore=ignore success=ok]         pam_localuser.so
password    requisite                                    pam_pwhistory.so use_authtok
password    sufficient                                   pam_unix.so sha512 shadow  use_authtok
password    [success=1 default=ignore]                   pam_localuser.so
password    sufficient                                   pam_sss.so use_authtok
password    required                                     pam_deny.so

session     optional                                     pam_keyinit.so revoke
session     required                                     pam_limits.so
-session    optional                                     pam_systemd.so
session     [success=1 default=ignore]                   pam_succeed_if.so service in crond quiet use_uid
session     required                                     pam_unix.so
session     optional                                     pam_sss.so

----

PAM Password Auth Configuration:
[source, bash]
----
auth        required                                     pam_env.so
auth        required                                     pam_faildelay.so delay=2000000
auth        required                                     pam_faillock.so preauth silent
auth        [default=1 ignore=ignore success=ok]         pam_usertype.so isregular
auth        [default=1 ignore=ignore success=ok]         pam_localuser.so
auth        sufficient                                   pam_unix.so
auth        [default=1 ignore=ignore success=ok]         pam_usertype.so isregular
auth        sufficient                                   pam_sss.so forward_pass
auth        required                                     pam_faillock.so authfail
auth        required                                     pam_deny.so

account     required                                     pam_faillock.so
account     required                                     pam_unix.so
account     sufficient                                   pam_localuser.so
account     sufficient                                   pam_usertype.so issystem
account     [default=bad success=ok user_unknown=ignore] pam_sss.so
account     required                                     pam_permit.so

password    requisite                                    pam_pwquality.so local_users_only
password    [default=1 ignore=ignore success=ok]         pam_localuser.so
password    requisite                                    pam_pwhistory.so use_authtok
password    sufficient                                   pam_unix.so sha512 shadow  use_authtok
password    [success=1 default=ignore]                   pam_localuser.so
password    sufficient                                   pam_sss.so use_authtok
password    required                                     pam_deny.so

session     optional                                     pam_keyinit.so revoke
session     required                                     pam_limits.so
-session    optional                                     pam_systemd.so
session     [success=1 default=ignore]                   pam_succeed_if.so service in crond quiet use_uid
session     required                                     pam_unix.so
session     optional                                     pam_sss.so

----

Sudo Logging:
[source, bash]
----
-rw-------. 1 root root  318108 Aug  6 21:44 /var/log/sudo.log

----

Users with Sudo Privileges:
[source, bash]
----
    (ALL) ALL

----

Non-root Users in Sudo/Wheel Groups:
[source, bash]
----
None

----

Users with UID 0 (root privileges):
[source, bash]
----
None

----

**Observation**

Local users with root or sudo privileges detected

**Recommendation**

Consider implementing Red Hat IdM (Identity Management) for centralized and granular control of user privileges

Review and remove unnecessary sudo privileges from local users

Implement a proper privilege escalation workflow through a centralized system

*Reference Link(s)*

* https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/8/html/planning_identity_management/index

== Kerberos Configuration

[cols="^"] 
|===
|
{set:cellbgcolor:#A6B9BF}
Not Applicable
|===

Kerberos Installation:
[source, bash]
----
Kerberos not installed

----

**Observation**

Kerberos is not configured on this system

**Recommendation**

This check is not applicable as Kerberos is not being used

*Reference Link(s)*

* https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/

<<<

{set:cellbgcolor!}

# Services

[cols="1,2,2,3", options=header]
|===
|*Category*
|*Item Evaluated*
|*Observed Result*
|*Recommendation*

// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/backup-systems.item

// Category
|
{set:cellbgcolor!}
Services

// Item Evaluated
a|
<<Backup Systems>>

| Backup system appears to be configured 

| 
{set:cellbgcolor:#00FF00}
No Change

// ------------------------ITEM END
// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/backup-recovery.item

// Category
|
{set:cellbgcolor!}
Services

// Item Evaluated
a|
<<Recovery Process>>

| No evidence of recent recovery testing found 

| 
{set:cellbgcolor:#FEFE20}
Changes Recommended

// ------------------------ITEM END
// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/backup-application.item

// Category
|
{set:cellbgcolor!}
Services

// Item Evaluated
a|
<<Application Backups>>

| No applications requiring specialized backups detected 

| 
{set:cellbgcolor:#80E5FF}
Advisory

// ------------------------ITEM END
// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/logs-system-errors.item

// Category
|
{set:cellbgcolor!}
Services

// Item Evaluated
a|
<<System Logs Check>>

| Found 33 errors in system logs 

| 
{set:cellbgcolor:#FEFE20}
Changes Recommended

// ------------------------ITEM END
// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/logs-rotation.item

// Category
|
{set:cellbgcolor!}
Services

// Item Evaluated
a|
<<Log Rotation>>

| Found 2 log rotation issues 

| 
{set:cellbgcolor:#FEFE20}
Changes Recommended

// ------------------------ITEM END
// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/logs-system.item

// Category
|
{set:cellbgcolor!}
Services

// Item Evaluated
a|
<<Logging System>>

| No logging service is active 

| 
{set:cellbgcolor:#FEFE20}
Changes Recommended

// ------------------------ITEM END
// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/monitoring-logs.item

// Category
|
{set:cellbgcolor!}
Services

// Item Evaluated
a|
<<Centralized Logging>>

| No active logging services detected 

| 
{set:cellbgcolor:#FEFE20}
Changes Recommended

// ------------------------ITEM END
// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/monitoring-alerts.item

// Category
|
{set:cellbgcolor!}
Services

// Item Evaluated
a|
<<Alerting Rules>>

| Alerting rules appear to be configured 

| 
{set:cellbgcolor:#00FF00}
No Change

// ------------------------ITEM END
// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/monitoring-agents.item

// Category
|
{set:cellbgcolor!}
Services

// Item Evaluated
a|
<<Monitoring Agents>>

| Monitoring agents installed but not running 

| 
{set:cellbgcolor:#FEFE20}
Changes Recommended

// ------------------------ITEM END
// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/services-unnecessary.item

// Category
|
{set:cellbgcolor!}
Services

// Item Evaluated
a|
<<Unnecessary Services>>

| No unnecessary services were identified 

| 
{set:cellbgcolor:#00FF00}
No Change

// ------------------------ITEM END
// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/services-required.item

// Category
|
{set:cellbgcolor!}
Services

// Item Evaluated
a|
<<Required Services>>

| Found issues with 12 required services 

| 
{set:cellbgcolor:#FEFE20}
Changes Recommended

// ------------------------ITEM END
// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/boot-target.item

// Category
|
{set:cellbgcolor!}
Services

// Item Evaluated
a|
<<Boot Target>>

| Unusual default boot target:  

| 
{set:cellbgcolor:#FEFE20}
Changes Recommended

// ------------------------ITEM END
// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/boot-errors.item

// Category
|
{set:cellbgcolor!}
Services

// Item Evaluated
a|
<<Boot Errors>>

| Found 131 boot errors and 0 failed units 

| 
{set:cellbgcolor:#FEFE20}
Changes Recommended

// ------------------------ITEM END
|===

== Backup Systems

[cols="^"] 
|===
|
{set:cellbgcolor:#00FF00}
No Change
|===

Backup Tools Installed:
[source, bash]
----

----

Backup Cron Jobs:
[source, bash]
----

----

Backup Directories:
[source, bash]
----

----

Backup Mounts:
[source, bash]
----

----

LVM Snapshots:
[source, bash]
----

----

**Observation**

Backup system appears to be configured

**Recommendation**

None

*Reference Link(s)*

* https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/

== Recovery Process

[cols="^"] 
|===
|
{set:cellbgcolor:#FEFE20}
Changes Recommended
|===

Recovery Documentation:
[source, bash]
----
bash: -c: line 2: syntax error: unexpected end of file

----

Recovery Scripts:
[source, bash]
----
/etc/dhcp/dhclient.d/chrony.sh

----

Restore/Recovery Logs:
[source, bash]
----

----

**Observation**

No evidence of recent recovery testing found

**Recommendation**

Perform and document regular recovery testing

Keep logs of recovery tests for verification

*Reference Link(s)*

* https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/8/html/system_design_guide/backup-and-recovery

== Application Backups

[cols="^"] 
|===
|
{set:cellbgcolor:#80E5FF}
Advisory
|===

Detected Applications:
[source, bash]
----

----

Database Backup Configurations:
[source, bash]
----

----

Recent Database Dumps (last 30 days):
[source, bash]
----
/proc
/sys

----

Application Backup Tools:
[source, bash]
----

----

**Observation**

No applications requiring specialized backups detected

**Recommendation**

Ensure system-level backups are in place

*Reference Link(s)*

* https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/8/html/system_design_guide/backup-and-recovery

== System Logs Check

[cols="^"] 
|===
|
{set:cellbgcolor:#FEFE20}
Changes Recommended
|===

Recent Journal Errors (Priority 0-3):
[source, bash]
----
-- Boot ba9f83a93b82408cbedb0210ec84335e --
Aug 06 09:17:22 rhel1.example.com kernel: Warning: Unmaintained driver is detected: ip_set
Aug 06 09:17:22 rhel1.example.com rsyslogd[924]: imjournal: fscanf on state file `/var/lib/rsyslog/imjournal.state' failed  [v8.2412.0-1.el9 try https://www.rsyslog.com/e/2027 ]
Aug 06 09:17:22 rhel1.example.com rsyslogd[924]: imjournal: ignoring invalid state file /var/lib/rsyslog/imjournal.state [v8.2412.0-1.el9]
Aug 06 09:18:32 rhel3.example.com dbus-broker-launch[817]: Activation request for 'org.freedesktop.nm_dispatcher' failed.
-- Boot 9fbbfd33fa7b4c589912a7cabbb28245 --
Aug 06 09:18:45 rhel3.example.com kernel: Warning: Unmaintained driver is detected: ip_set
Aug 06 09:58:44 rhel3.example.com sshd[1555]: error: no more sessions
Aug 06 10:11:32 rhel3.example.com sshd[2338]: error: no more sessions
Aug 06 10:33:44 rhel3.example.com sshd[2866]: error: no more sessions
Aug 06 10:33:44 rhel3.example.com sshd[2866]: error: no more sessions
Aug 06 10:33:44 rhel3.example.com sshd[2866]: error: no more sessions
Aug 06 10:33:44 rhel3.example.com sshd[2866]: error: no more sessions
Aug 06 10:33:44 rhel3.example.com sshd[2866]: error: no more sessions
Aug 06 10:33:44 rhel3.example.com sshd[2866]: error: no more sessions
Aug 06 10:33:44 rhel3.example.com sshd[2866]: error: no more sessions
Aug 06 10:33:44 rhel3.example.com sshd[2866]: error: no more sessions
Aug 06 10:33:44 rhel3.example.com sshd[2866]: error: no more sessions
Aug 06 10:33:44 rhel3.example.com sshd[2866]: error: no more sessions

----

Kernel Log Errors:
[source, bash]
----
[    0.106795] PCI: Using host bridge windows from ACPI; if necessary, use "pci=nocrs" and report a bug
[    1.980543] SGI XFS with ACLs, security attributes, scrub, quota, no debug enabled
[    2.349109] systemd[1]: Mounting Kernel Debug File System...
[    2.382965] systemd[1]: Mounted Kernel Debug File System.
[    5.005805] Warning: Unmaintained driver is detected: ip_set

----

Authentication Failures:
[source, bash]
----
/var/log/secure:Aug  6 09:34:15 rhel3 sshd[1487]: pam_unix(sshd:auth): authentication failure; logname= uid=0 euid=0 tty=ssh ruser= rhost=192.168.1.16  user=ayaseen
/var/log/secure:Aug  6 18:16:08 rhel3 sshd[7157]: pam_unix(sshd:auth): authentication failure; logname= uid=0 euid=0 tty=ssh ruser= rhost=192.168.1.16  user=root
/var/log/secure:Aug  6 18:18:19 rhel3 sshd[7163]: pam_unix(sshd:auth): authentication failure; logname= uid=0 euid=0 tty=ssh ruser= rhost=192.168.1.16  user=root
/var/log/secure:Aug  6 19:12:09 rhel3 sudo[8504]: ayaseen : PWD=/home/ayaseen ; USER=root ; COMMAND=/bin/bash -c 'grep -i \'authentication failure\' /var/log/secure /var/log/auth.log 2>/dev/null | tail -10'
/var/log/secure:Aug  6 19:26:29 rhel3 sudo[21320]: ayaseen : PWD=/home/ayaseen ; USER=root ; COMMAND=/bin/bash -c 'grep -i \'authentication failure\' /var/log/secure /var/log/auth.log 2>/dev/null | tail -10'
/var/log/secure:Aug  6 19:57:02 rhel3 sudo[26030]: ayaseen : PWD=/home/ayaseen ; USER=root ; COMMAND=/bin/bash -c 'grep -i \'authentication failure\' /var/log/secure /var/log/auth.log 2>/dev/null | tail -10'
/var/log/secure:Aug  6 19:57:32 rhel3 sudo[26056]: ayaseen : PWD=/home/ayaseen ; USER=root ; COMMAND=/bin/bash -c 'grep -i \'authentication failure\' /var/log/secure /var/log/auth.log 2>/dev/null | tail -10'
/var/log/secure:Aug  6 21:40:27 rhel3 sudo[27515]: ayaseen : PWD=/home/ayaseen ; USER=root ; COMMAND=/bin/bash -c 'grep -i \'authentication failure\' /var/log/secure /var/log/auth.log 2>/dev/null | tail -10'
/var/log/secure:Aug  6 21:41:09 rhel3 sudo[34135]: ayaseen : PWD=/home/ayaseen ; USER=root ; COMMAND=/bin/bash -c 'grep -i \'authentication failure\' /var/log/secure /var/log/auth.log 2>/dev/null | tail -10'

----

**Observation**

Found 33 errors in system logs

**Recommendation**

Review system logs for potential issues

Review journal logs with 'journalctl -p 0..3'

Review kernel messages with 'dmesg | grep -i error'

*Reference Link(s)*

* https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/8/html/monitoring_and_managing_system_status_and_performance/indexviewing-problems-with-journalctl_logging-and-monitoring

== Log Rotation

[cols="^"] 
|===
|
{set:cellbgcolor:#FEFE20}
Changes Recommended
|===

Logrotate Configuration:
[source, bash]
----

# global options do not affect preceding include directives

# rotate log files weekly
weekly

# keep 4 weeks worth of backlogs
rotate 4

# create new (empty) log files after rotating old ones
create

# use date as a suffix of the rotated file
dateext

# uncomment this if you want your log files compressed
#compress

# packages drop log rotation information into this directory
include /etc/logrotate.d

# system-specific logs may be also be configured here.

----

Logrotate.d Directory Contents:
[source, bash]
----
-rw-r--r--. 1 root root 155 Jan 17  2025 aide
-rw-r--r--. 1 root root 130 Oct 14  2019 btmp
-rw-r--r--. 1 root root 160 Oct  8  2024 chrony
-rw-r--r--. 1 root root  88 Sep  9  2022 dnf
-rw-r--r--. 1 root root  93 Nov  7  2024 firewalld
-rw-r--r--. 1 root root 105 Aug 19  2024 insights-client
-rw-r--r--. 1 root root 162 Apr  4 17:49 kvm_stat
-rw-r--r--. 1 root root 226 Dec 17  2024 rsyslog
-rw-r--r--. 1 root root 289 Feb 12 18:38 sssd
-rw-r--r--. 1 root root  88 Feb 11 19:35 subscription-manager
-rw-r--r--. 1 root root 145 Oct 14  2019 wtmp

----

No log files larger than 100MB found

Logrotate Configuration Errors:
[source, bash]
----
error: error opening state file /var/lib/logrotate/logrotate.status: No such file or directory

----

**Observation**

Found 2 log rotation issues

**Recommendation**

Errors found in logrotate configuration

Log compression not enabled (consider enabling for better space utilization)

Review logrotate configuration in /etc/logrotate.conf and /etc/logrotate.d/

Test logrotate configuration with 'logrotate -d /etc/logrotate.conf'

Enable compression by uncommenting the 'compress' line in /etc/logrotate.conf

*Reference Link(s)*

* https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/8/html/monitoring_and_managing_system_status_and_performance/indexassembly_managing-logs_logging-and-monitoring

== Logging System

[cols="^"] 
|===
|
{set:cellbgcolor:#FEFE20}
Changes Recommended
|===

Rsyslog Service Active: false

Journald Service Active: false


Rsyslog Configuration:
[source, bash]
----


global(workDirectory="/var/lib/rsyslog")

module(load="builtin:omfile" Template="RSYSLOG_TraditionalFileFormat")


module(load="imuxsock" 	  # provides support for local system logging (e.g. via logger command)
       SysSock.Use="off") # Turn off message reception via local log socket; 
			  # local messages are retrieved through imjournal now.
module(load="imjournal" 	    # provides access to the systemd journal
       UsePid="system" # PID nummber is retrieved as the ID of the process the journal entry originates from
       FileCreateMode="0644" # Set the access permissions for the state file
       StateFile="imjournal.state") # File to store the position in the journal

include(file="/etc/rsyslog.d/*.conf" mode="optional")





*.info;mail.none;authpriv.none;cron.none                /var/log/messages

authpriv.*                                              /var/log/secure

mail.*                                                  -/var/log/maillog


cron.*                                                  /var/log/cron

*.emerg                                                 :omusrmsg:*

uucp,news.crit                                          /var/log/spooler

local7.*                                                /var/log/boot.log



----

Journald Configuration:
[source, bash]
----
[Journal]
Storage=persistent
Compress=yes
Audit=

----

Journal Disk Usage:
[source, bash]
----

----

Configured Log Destinations:
[source, bash]
----
/etc/rsyslog.conf:authpriv.*                                              /var/log/secure
/etc/rsyslog.conf:mail.*                                                  -/var/log/maillog
/etc/rsyslog.conf:cron.*                                                  /var/log/cron
/etc/rsyslog.conf:uucp,news.crit                                          /var/log/spooler
/etc/rsyslog.conf:local7.*                                                /var/log/boot.log

----

Configured Syslog Facilities:
[source, bash]
----
No syslog facilities found in rsyslog configuration

----

Remote Logging Configuration:
[source, bash]
----

----

**Observation**

No logging service is active

**Recommendation**

Start at least one logging service: 'systemctl start rsyslog'

Enable the service to start at boot: 'systemctl enable rsyslog'

*Reference Link(s)*

* https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/8/html/monitoring_and_managing_system_status_and_performance/indexconfiguring-and-managing-logging_logging-and-monitoring

== Centralized Logging

[cols="^"] 
|===
|
{set:cellbgcolor:#FEFE20}
Changes Recommended
|===

Rsyslog Remote Logging Configuration:
[source, bash]
----

----

Journald Forwarding Configuration:
[source, bash]
----

----

Logging Agents Installed:
[source, bash]
----

----

Logging Services Status:
No active logging services detected


Logging Network Connections:
[source, bash]
----

----

Outbound Logging Connections:
[source, bash]
----

----

**Observation**

No active logging services detected

**Recommendation**

Start and enable rsyslog: 'systemctl enable --now rsyslog'

Or configure another logging solution for centralized logging

*Reference Link(s)*

* https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/8/html/monitoring_and_managing_system_status_and_performance/index

== Alerting Rules

[cols="^"] 
|===
|
{set:cellbgcolor:#00FF00}
No Change
|===

Monitoring Systems Installed:
[source, bash]
----

----

Alerting Configurations:
[source, bash]
----

----

Monitoring Agents Status:
No active monitoring agents detected


Alert Manager Connections:
[source, bash]
----

----

Email Alerting Configuration:
[source, bash]
----

----

**Observation**

Alerting rules appear to be configured

**Recommendation**

None

*Reference Link(s)*

* https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/

== Monitoring Agents

[cols="^"] 
|===
|
{set:cellbgcolor:#FEFE20}
Changes Recommended
|===

Monitoring Agents Installed:
[source, bash]
----

----

Monitoring Agent Services:
No monitoring agent services found


Monitoring Ports Open:
[source, bash]
----

----

Monitoring Agent Configurations:
[source, bash]
----

----

Firewall Rules for Monitoring:
[source, bash]
----

----

**Observation**

Monitoring agents installed but not running

**Recommendation**

Start and enable monitoring agent services

Example: 'systemctl enable --now zabbix-agent'

*Reference Link(s)*

* https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/8/html/monitoring_and_managing_system_status_and_performance/index

== Unnecessary Services

[cols="^"] 
|===
|
{set:cellbgcolor:#00FF00}
No Change
|===

List of Potentially Unnecessary Services:
[source, bash]
----

--- avahi-daemon ---

--- cups ---

--- isc-dhcp-server ---

--- nfs-server ---

--- rpcbind ---

--- telnet ---

--- vsftpd ---

--- xinetd ---

--- bluetooth ---

--- rsh ---

--- ypbind ---

----

Listening Services and Ports:
[source, bash]
----
udp   UNCONN 0      0          127.0.0.1:323       0.0.0.0:*    users:(("chronyd",pid=830,fd=5))
udp   UNCONN 0      0              [::1]:323          [::]:*    users:(("chronyd",pid=830,fd=6))
tcp   LISTEN 0      128          0.0.0.0:22        0.0.0.0:*    users:(("sshd",pid=865,fd=3))   
tcp   LISTEN 0      128             [::]:22           [::]:*    users:(("sshd",pid=865,fd=4))   

----

**Observation**

No unnecessary services were identified

**Recommendation**

None

*Reference Link(s)*

* https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/

== Required Services

[cols="^"] 
|===
|
{set:cellbgcolor:#FEFE20}
Changes Recommended
|===

Status of Required Services:
[source, bash]
----
sshd: Status=, Boot=
chronyd: Status=, Boot=
auditd: Status=, Boot=
rsyslog: Status=, Boot=
crond: Status=, Boot=
firewalld: Status=, Boot=

----

All Active Services:
[source, bash]
----
  auditd.service                     loaded active running Security Auditing Service
  chronyd.service                    loaded active running NTP client/server
  crond.service                      loaded active running Command Scheduler
  dbus-broker.service                loaded active running D-Bus System Message Bus
  dracut-shutdown.service            loaded active exited  Restore /run/initramfs on shutdown
  firewalld.service                  loaded active running firewalld - dynamic firewall daemon
  getty@tty1.service                 loaded active running Getty on tty1
  irqbalance.service                 loaded active running irqbalance daemon
  kdump.service                      loaded active exited  Crash recovery kernel arming
  kmod-static-nodes.service          loaded active exited  Create List of Static Device Nodes
  lvm2-monitor.service               loaded active exited  Monitoring of LVM2 mirrors, snapshots etc. using dmeventd or progress polling
  NetworkManager-wait-online.service loaded active exited  Network Manager Wait Online
  NetworkManager.service             loaded active running Network Manager
  nis-domainname.service             loaded active exited  Read and set NIS domainname from /etc/sysconfig/network
  qemu-guest-agent.service           loaded active running QEMU Guest Agent
  rhsmcertd.service                  loaded active running Enable periodic update of entitlement certificates.
  rsyslog.service                    loaded active running System Logging Service
  sshd.service                       loaded active running OpenSSH server daemon
  systemd-boot-update.service        loaded active exited  Automatic Boot Loader Update
  systemd-journal-flush.service      loaded active exited  Flush Journal to Persistent Storage
  systemd-journald.service           loaded active running Journal Service
  systemd-logind.service             loaded active running User Login Management
  systemd-network-generator.service  loaded active exited  Generate network units from Kernel command line
  systemd-random-seed.service        loaded active exited  Load/Save OS Random Seed
  systemd-remount-fs.service         loaded active exited  Remount Root and Kernel File Systems
  systemd-sysctl.service             loaded active exited  Apply Kernel Variables
  systemd-tmpfiles-setup-dev.service loaded active exited  Create Static Device Nodes in /dev
  systemd-tmpfiles-setup.service     loaded active exited  Create Volatile Files and Directories
  systemd-udev-trigger.service       loaded active exited  Coldplug All udev Devices
  systemd-udevd.service              loaded active running Rule-based Manager for Device Events and Files
  systemd-update-utmp.service        loaded active exited  Record System Boot/Shutdown in UTMP
  systemd-user-sessions.service      loaded active exited  Permit User Sessions
  user-runtime-dir@1000.service      loaded active exited  User Runtime Directory /run/user/1000
  user@1000.service                  loaded active running User Manager for UID 1000

LOAD   = Reflects whether the unit definition was properly loaded.
ACTIVE = The high-level unit activation state, i.e. generalization of SUB.
SUB    = The low-level unit activation state, values depend on unit type.
34 loaded units listed.

----

**Observation**

Found issues with 12 required services

**Recommendation**

Start service 'sshd': 'systemctl start sshd'

Start service 'chronyd': 'systemctl start chronyd'

Start service 'auditd': 'systemctl start auditd'

Start service 'rsyslog': 'systemctl start rsyslog'

Start service 'crond': 'systemctl start crond'

Start service 'firewalld': 'systemctl start firewalld'

Enable and start service 'sshd': 'systemctl enable --now sshd'

Enable and start service 'chronyd': 'systemctl enable --now chronyd'

Enable and start service 'auditd': 'systemctl enable --now auditd'

Enable and start service 'rsyslog': 'systemctl enable --now rsyslog'

Enable and start service 'crond': 'systemctl enable --now crond'

Enable and start service 'firewalld': 'systemctl enable --now firewalld'

*Reference Link(s)*

* https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/8/html/using_systemd_unit_files_to_customize_and_optimize_your_system/index

== Boot Target

[cols="^"] 
|===
|
{set:cellbgcolor:#FEFE20}
Changes Recommended
|===

Boot Target Information:
[source, bash]
----
Default Boot Target: 
GUI Packages Installed: false (found 0 packages)
Server Role Detected: true (found 0 server packages)

----

Available Targets:
[source, bash]
----
/lib/systemd/system/timers.target
/lib/systemd/system/basic.target
/lib/systemd/system/blockdev@.target
/lib/systemd/system/bluetooth.target
/lib/systemd/system/boot-complete.target
/lib/systemd/system/ctrl-alt-del.target
/lib/systemd/system/default.target
/lib/systemd/system/time-set.target
/lib/systemd/system/emergency.target
/lib/systemd/system/exit.target
/lib/systemd/system/factory-reset.target
/lib/systemd/system/final.target
/lib/systemd/system/first-boot-complete.target
/lib/systemd/system/getty-pre.target
/lib/systemd/system/getty.target
/lib/systemd/system/graphical.target
/lib/systemd/system/halt.target
/lib/systemd/system/kexec.target
/lib/systemd/system/network-pre.target
/lib/systemd/system/runlevel5.target
/lib/systemd/system/local-fs-pre.target
/lib/systemd/system/local-fs.target
/lib/systemd/system/multi-user.target
/lib/systemd/system/network-online.target
/lib/systemd/system/network.target
/lib/systemd/system/runlevel6.target
/lib/systemd/system/nss-lookup.target
/lib/systemd/system/nss-user-lookup.target
/lib/systemd/system/paths.target
/lib/systemd/system/poweroff.target
/lib/systemd/system/printer.target
/lib/systemd/system/reboot.target
/lib/systemd/system/remote-fs-pre.target
/lib/systemd/system/remote-fs.target
/lib/systemd/system/rescue.target
/lib/systemd/system/rpcbind.target
/lib/systemd/system/runlevel0.target
/lib/systemd/system/runlevel1.target
/lib/systemd/system/runlevel4.target
/lib/systemd/system/runlevel2.target
/lib/systemd/system/runlevel3.target
/lib/systemd/system/sigpwr.target
/lib/systemd/system/shutdown.target
/lib/systemd/system/slices.target
/lib/systemd/system/smartcard.target
/lib/systemd/system/sockets.target
/lib/systemd/system/sound.target
/lib/systemd/system/swap.target
/lib/systemd/system/sysinit.target
/lib/systemd/system/umount.target
/lib/systemd/system/system-update-pre.target
/lib/systemd/system/system-update.target
/lib/systemd/system/usb-gadget.target
/lib/systemd/system/cryptsetup-pre.target
/lib/systemd/system/hibernate.target
/lib/systemd/system/initrd-root-fs.target
/lib/systemd/system/initrd-switch-root.target
/lib/systemd/system/initrd-usr-fs.target
/lib/systemd/system/integritysetup-pre.target
/lib/systemd/system/integritysetup.target
/lib/systemd/system/remote-veritysetup.target
/lib/systemd/system/suspend-then-hibernate.target
/lib/systemd/system/veritysetup.target
/lib/systemd/system/cryptsetup.target
/lib/systemd/system/hybrid-sleep.target
/lib/systemd/system/initrd-fs.target
/lib/systemd/system/initrd-root-device.target
/lib/systemd/system/initrd.target
/lib/systemd/system/remote-cryptsetup.target
/lib/systemd/system/sleep.target
/lib/systemd/system/suspend.target
/lib/systemd/system/selinux-autorelabel.target
/lib/systemd/system/veritysetup-pre.target
/lib/systemd/system/sshd-keygen.target
/etc/systemd/system/ctrl-alt-del.target
/etc/systemd/system/default.target

----

**Observation**

Unusual default boot target: 

**Recommendation**

Verify this target is appropriate for your use case

RHEL best practice is to use multi-user.target (text mode)

*Reference Link(s)*

* https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/8/html/using_systemd_unit_files_to_customize_and_optimize_your_system/index

== Boot Errors

[cols="^"] 
|===
|
{set:cellbgcolor:#FEFE20}
Changes Recommended
|===

Boot Error Messages:
[source, bash]
----
Aug 06 09:58:44 rhel3.example.com sshd[1555]: error: no more sessions
Aug 06 10:11:32 rhel3.example.com sshd[2338]: error: no more sessions
Aug 06 10:33:44 rhel3.example.com sshd[2866]: error: no more sessions
Aug 06 10:33:44 rhel3.example.com sshd[2866]: error: no more sessions
Aug 06 10:33:44 rhel3.example.com sshd[2866]: error: no more sessions
Aug 06 10:33:44 rhel3.example.com sshd[2866]: error: no more sessions
Aug 06 10:33:44 rhel3.example.com sshd[2866]: error: no more sessions
Aug 06 10:33:44 rhel3.example.com sshd[2866]: error: no more sessions
Aug 06 10:33:44 rhel3.example.com sshd[2866]: error: no more sessions
Aug 06 10:33:44 rhel3.example.com sshd[2866]: error: no more sessions
Aug 06 10:33:44 rhel3.example.com sshd[2866]: error: no more sessions
Aug 06 10:33:44 rhel3.example.com sshd[2866]: error: no more sessions
Aug 06 12:02:09 rhel3.example.com sshd[4529]: error: no more sessions
Aug 06 12:02:09 rhel3.example.com sshd[4529]: error: no more sessions
Aug 06 19:02:02 rhel3.example.com sshd[7870]: error: session_signal_req: no pid for session 1
Aug 06 19:12:01 rhel3.example.com sshd[8101]: error: session_signal_req: no pid for session 1
Aug 06 19:26:22 rhel3.example.com sshd[20910]: error: session_signal_req: no pid for session 1
Aug 06 19:41:39 rhel3.example.com sshd[25809]: error: session_signal_req: no pid for session 0
Aug 06 19:59:17 rhel3.example.com sshd[26092]: error: kex_exchange_identification: Connection closed by remote host
Aug 06 20:14:42 rhel3.example.com sudo[26481]: pam_unix(sudo:auth): conversation failed
... (output truncated, showing first 20 lines out of 131)

----

Failed Units:
[source, bash]
----
0 loaded units listed.

----

Kernel Error Messages:
[source, bash]
----
No critical kernel errors found

----

**Observation**

Found 131 boot errors and 0 failed units

**Recommendation**

Review boot errors with 'journalctl -p 0..3 -b'

Check failed services with 'systemctl --failed'

Investigate and resolve service failures

*Reference Link(s)*

* https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/8/html/configuring_basic_system_settings/assembly_troubleshooting-problems-using-log-files_configuring-basic-system-settings

<<<

{set:cellbgcolor!}

# Networking

[cols="1,2,2,3", options=header]
|===
|*Category*
|*Item Evaluated*
|*Observed Result*
|*Recommendation*

// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/network-config.item

// Category
|
{set:cellbgcolor!}
Networking

// Item Evaluated
a|
<<Network Configuration>>

| Found 1 network configuration issues 

| 
{set:cellbgcolor:#FEFE20}
Changes Recommended

// ------------------------ITEM END
// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/connectivity-services.item

// Category
|
{set:cellbgcolor!}
Networking

// Item Evaluated
a|
<<Dependent Services>>

| 4 of 4 local services may be unreachable 

| 
{set:cellbgcolor:#80E5FF}
Advisory

// ------------------------ITEM END
// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/connectivity-dns.item

// Category
|
{set:cellbgcolor!}
Networking

// Item Evaluated
a|
<<DNS Records>>

| Found 2 DNS resolution issues 

| 
{set:cellbgcolor:#FEFE20}
Changes Recommended

// ------------------------ITEM END
// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/ha-multicast.item

// Category
|
{set:cellbgcolor!}
Networking

// Item Evaluated
a|
<<Multicast Configuration>>

| System is not a cluster member 

| 
{set:cellbgcolor:#A6B9BF}
Not Applicable

// ------------------------ITEM END
// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/ha-fencing-network.item

// Category
|
{set:cellbgcolor!}
Networking

// Item Evaluated
a|
<<Fencing Network>>

| System is not a cluster member 

| 
{set:cellbgcolor:#A6B9BF}
Not Applicable

// ------------------------ITEM END
// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/network-bonding.item

// Category
|
{set:cellbgcolor!}
Networking

// Item Evaluated
a|
<<Network Bonding/Teaming>>

| Network bonding is not applicable with only one network interface 

| 
{set:cellbgcolor:#A6B9BF}
Not Applicable

// ------------------------ITEM END
// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/connectivity-latency.item

// Category
|
{set:cellbgcolor!}
Networking

// Item Evaluated
a|
<<Network Latency>>

| Network latency to key systems is within acceptable ranges 

| 
{set:cellbgcolor:#00FF00}
No Change

// ------------------------ITEM END
// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/hostname-resolution.item

// Category
|
{set:cellbgcolor!}
Networking

// Item Evaluated
a|
<<Hostname Resolution>>

| Hostname resolution is working correctly 

| 
{set:cellbgcolor:#00FF00}
No Change

// ------------------------ITEM END
// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/network-mtu.item

// Category
|
{set:cellbgcolor!}
Networking

// Item Evaluated
a|
<<MTU Configuration>>

| Standard MTU (1500) is used on all interfaces 

| 
{set:cellbgcolor:#00FF00}
No Change

// ------------------------ITEM END
// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/firewall-rules.item

// Category
|
{set:cellbgcolor!}
Networking

// Item Evaluated
a|
<<Firewall Rules>>

| No firewall service is active 

| 
{set:cellbgcolor:#FEFE20}
Changes Recommended

// ------------------------ITEM END
// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/network-tcp-ip-hardening.item

// Category
|
{set:cellbgcolor!}
Networking

// Item Evaluated
a|
<<TCP/IP Stack Hardening>>

| Found 1 missing TCP/IP security settings 

| 
{set:cellbgcolor:#FEFE20}
Changes Recommended

// ------------------------ITEM END
|===

== Network Configuration

[cols="^"] 
|===
|
{set:cellbgcolor:#FEFE20}
Changes Recommended
|===

IP Configuration:
[source, bash]
----
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
    inet 127.0.0.1/8 scope host lo
       valid_lft forever preferred_lft forever
    inet6 ::1/128 scope host 
       valid_lft forever preferred_lft forever
2: enp1s0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc fq_codel state UP group default qlen 1000
    link/ether 52:54:00:48:c3:63 brd ff:ff:ff:ff:ff:ff
    inet 192.168.1.102/24 brd 192.168.1.255 scope global noprefixroute enp1s0
       valid_lft forever preferred_lft forever
    inet6 fe80::5054:ff:fe48:c363/64 scope link noprefixroute 
       valid_lft forever preferred_lft forever

----


Routing Information:
[source, bash]
----
192.168.1.0/24 dev enp1s0 proto kernel scope link src 192.168.1.102 metric 100 

----


DNS Configuration:
[source, bash]
----
search example.com
nameserver 8.8.8.8

----


Network Interfaces (ifconfig):
[source, bash]
----

----


NetworkManager Status:
[source, bash]
----
enp1s0  ethernet  connected               enp1s0     
lo      loopback  connected (externally)  lo         

----

**Observation**

Found 1 network configuration issues

**Recommendation**

No default gateway configured

Configure a default gateway using 'ip route add default via GATEWAY_IP'

*Reference Link(s)*

* https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/8/html/configuring_and_managing_networking/

== Dependent Services

[cols="^"] 
|===
|
{set:cellbgcolor:#80E5FF}
Advisory
|===

Local Services:
[source, bash]
----
No common service ports detected

----

Database Configurations Found:
[source, bash]
----
/etc/aliases
/etc/authselect/custom/hardening/README
/etc/authselect/user-nsswitch.conf
/etc/authselect/nsswitch.conf

----

Connectivity Tests:
[source, bash]
----
Database (bash: line 3: /etc/authselect/user-nsswitch.conf: Permission denied:5432): Failed
Database (bash: line 4: /etc/authselect/nsswitch.conf: Permission denied:5432): Failed
Database (IP) (bash: line 3: /etc/authselect/user-nsswitch.conf: Permission denied:5432): Failed
Database (IP) (bash: line 4: /etc/authselect/nsswitch.conf: Permission denied:5432): Failed

----

**Observation**

4 of 4 local services may be unreachable

**Recommendation**

Verify connectivity to Database (bash: line 3: /etc/authselect/user-nsswitch.conf: Permission denied:5432)

Verify connectivity to Database (bash: line 4: /etc/authselect/nsswitch.conf: Permission denied:5432)

Verify connectivity to Database (IP) (bash: line 3: /etc/authselect/user-nsswitch.conf: Permission denied:5432)

Verify connectivity to Database (IP) (bash: line 4: /etc/authselect/nsswitch.conf: Permission denied:5432)

*Reference Link(s)*

* https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/8/html/configuring_and_managing_networking/configuring-the-order-of-dns-servers_configuring-and-managing-networking

== DNS Records

[cols="^"] 
|===
|
{set:cellbgcolor:#FEFE20}
Changes Recommended
|===

Hostname Information:
[source, bash]
----
Hostname: 
IP Addresses: 

----

Forward DNS Lookup:
[source, bash]
----
No hostname available to lookup
----

Reverse DNS Lookups:
[source, bash]
----

----

DNS Configuration:
[source, bash]
----
nameserver 8.8.8.8

----

**Observation**

Found 2 DNS resolution issues

**Recommendation**

Forward DNS lookup for  failed

Only 1 nameserver(s) configured

Configure proper DNS records for this system's hostname and IP addresses

Configure at least two nameservers in /etc/resolv.conf for redundancy

*Reference Link(s)*

* https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/8/html/configuring_and_managing_networking/using-networkmanager-with-network-scripts_configuring-and-managing-networking

== Multicast Configuration

[cols="^"] 
|===
|
{set:cellbgcolor:#A6B9BF}
Not Applicable
|===

**Observation**

System is not a cluster member

**Recommendation**

This check is only applicable for cluster nodes

*Reference Link(s)*

* https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/

== Fencing Network

[cols="^"] 
|===
|
{set:cellbgcolor:#A6B9BF}
Not Applicable
|===

**Observation**

System is not a cluster member

**Recommendation**

This check is only applicable for cluster nodes

*Reference Link(s)*

* https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/

== Network Bonding/Teaming

[cols="^"] 
|===
|
{set:cellbgcolor:#A6B9BF}
Not Applicable
|===

Detected RHEL Version: 8

Bonding Module Status: Not loaded

Bonding Interfaces:
[source, bash]
----

----


Bonding Configuration Details:
[source, bash]
----

----


Network Interface Information:
[source, bash]
----
Total Network Interfaces: 0
Available Interfaces:

----

**Observation**

Network bonding is not applicable with only one network interface

**Recommendation**

Bonding/teaming requires at least two network interfaces

Add additional network interfaces to enable bonding/teaming

*Reference Link(s)*

* https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/

== Network Latency

[cols="^"] 
|===
|
{set:cellbgcolor:#00FF00}
No Change
|===

Network Latency Tests:
[source, bash]
----
Google DNS (8.8.8.8): Average latency: 26.391 ms
  Ping Output:
  64 bytes from 8.8.8.8: icmp_seq=1 ttl=111 time=25.4 ms
  64 bytes from 8.8.8.8: icmp_seq=2 ttl=111 time=26.5 ms
  64 bytes from 8.8.8.8: icmp_seq=3 ttl=111 time=27.3 ms
  --- 8.8.8.8 ping statistics ---
  3 packets transmitted, 3 received, 0% packet loss, time 2003ms
  rtt min/avg/max/mdev = 25.423/26.391/27.296/0.766 ms

Cloudflare DNS (1.1.1.1): Average latency: 7.710 ms
  Ping Output:
  64 bytes from 1.1.1.1: icmp_seq=1 ttl=54 time=6.78 ms
  64 bytes from 1.1.1.1: icmp_seq=2 ttl=54 time=7.83 ms
  64 bytes from 1.1.1.1: icmp_seq=3 ttl=54 time=8.52 ms
  --- 1.1.1.1 ping statistics ---
  3 packets transmitted, 3 received, 0% packet loss, time 2003ms
  rtt min/avg/max/mdev = 6.783/7.710/8.520/0.713 ms

Red Hat (access.redhat.com): Average latency: 59.655 ms
  Ping Output:
  64 bytes from a2-20-110-129.deploy.static.akamaitechnologies.com (2.20.110.129): icmp_seq=1 ttl=51 time=59.5 ms
  64 bytes from a2-20-110-129.deploy.static.akamaitechnologies.com (2.20.110.129): icmp_seq=2 ttl=51 time=59.5 ms
  64 bytes from a2-20-110-129.deploy.static.akamaitechnologies.com (2.20.110.129): icmp_seq=3 ttl=51 time=60.0 ms
  --- e259367.dsca.akamaiedge.net ping statistics ---
  3 packets transmitted, 3 received, 0% packet loss, time 2002ms
  rtt min/avg/max/mdev = 59.455/59.655/60.045/0.275 ms


----

Network Path to access.redhat.com:
[source, bash]
----
 1:  192.168.1.1                                           2.529ms 
 1:  192.168.1.1                                           3.256ms 
 2:  100.64.99.254                                         6.354ms 
 3:  10.0.60.1                                             6.350ms 
 4:  2.20.110.160                                         60.492ms reached
     Resume: pmtu 1492 hops 4 back 13 

----

**Observation**

Network latency to key systems is within acceptable ranges

**Recommendation**

None

*Reference Link(s)*

* https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/

== Hostname Resolution

[cols="^"] 
|===
|
{set:cellbgcolor:#00FF00}
No Change
|===

Hostname Information:
[source, bash]
----
Hostname: 
FQDN: 

----

Hostname Resolution Lookup:
[source, bash]
----
127.0.0.1       localhost localhost.localdomain localhost6 localhost6.localdomain6

----

FQDN Resolution Lookup:
[source, bash]
----
127.0.0.1       localhost localhost.localdomain localhost6 localhost6.localdomain6

----

/etc/hosts File:
[source, bash]
----
::1         localhost localhost.localdomain localhost6 localhost6.localdomain6

----

/etc/resolv.conf File:
[source, bash]
----
search example.com
nameserver 8.8.8.8

----

**Observation**

Hostname resolution is working correctly

**Recommendation**

None

*Reference Link(s)*

* https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/

== MTU Configuration

[cols="^"] 
|===
|
{set:cellbgcolor:#00FF00}
No Change
|===

Interface MTU Values:
[source, bash]
----
2: enp1s0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc fq_codel state UP mode DEFAULT group default qlen 1000

----


Network Configuration Files:
[source, bash]
----

----


MTU Settings in Network Scripts:
[source, bash]
----

----


NetworkManager MTU Settings:
[source, bash]
----

----


Firewall Multicast Rules:
[source, bash]
----

----

**Observation**

Standard MTU (1500) is used on all interfaces

**Recommendation**

None

*Reference Link(s)*

* https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/

== Firewall Rules

[cols="^"] 
|===
|
{set:cellbgcolor:#FEFE20}
Changes Recommended
|===

FirewallD Active: false
IPTables Service Active: false

FirewallD Configuration:
[source, bash]
----
  target: default
  icmp-block-inversion: no
  interfaces: enp1s0
  sources: 
  services: cockpit dhcpv6-client ssh
  ports: 
  protocols: 
  forward: yes
  masquerade: no
  forward-ports: 
  source-ports: 
  icmp-blocks: 
  rich rules: 

----

IPTables Rules:
[source, bash]
----
 pkts bytes target     prot opt in     out     source               destination         

Chain FORWARD (policy ACCEPT 0 packets, 0 bytes)
 pkts bytes target     prot opt in     out     source               destination         

Chain OUTPUT (policy ACCEPT 0 packets, 0 bytes)
 pkts bytes target     prot opt in     out     source               destination         

----

Open Ports:
[source, bash]
----
tcp   LISTEN 0      128             [::]:22           [::]:*   

----

Multicast Firewall Rules:
[source, bash]
----

----

**Observation**

No firewall service is active

**Recommendation**

Start and enable firewalld: 'systemctl enable --now firewalld'

Configure appropriate firewall rules for your services

*Reference Link(s)*

* https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/8/html/configuring_and_managing_networking/

== TCP/IP Stack Hardening

[cols="^"] 
|===
|
{set:cellbgcolor:#FEFE20}
Changes Recommended
|===

TCP/IP Stack Security Settings:
[source, bash]
----
net.ipv4.conf.all.accept_source_route = 0
net.ipv4.conf.all.rp_filter = 1
net.ipv4.conf.all.secure_redirects = 0
net.ipv4.conf.default.accept_redirects = 0
net.ipv4.conf.default.accept_source_route = 0
net.ipv4.conf.default.rp_filter = 1
net.ipv4.conf.default.secure_redirects = 0
net.ipv4.icmp_echo_ignore_broadcasts = 1
net.ipv4.ip_forward = 0
net.ipv4.ip_forward_update_priority = 1
net.ipv4.ip_forward_use_pmtu = 0
net.ipv4.tcp_syncookies = 1

----

Persistent TCP/IP Settings:
[source, bash]
----
/etc/sysctl.conf:net.ipv4.conf.all.accept_redirects = 0
/etc/sysctl.conf:# Per CCE-84001-7: Set net.ipv4.conf.all.accept_source_route = 0 in /etc/sysctl.conf
/etc/sysctl.conf:net.ipv4.conf.all.accept_source_route = 0
/etc/sysctl.conf:# Per CCE-84008-2: Set net.ipv4.conf.all.rp_filter = 1 in /etc/sysctl.conf
/etc/sysctl.conf:net.ipv4.conf.all.rp_filter = 1
/etc/sysctl.conf:# Per CCE-84016-5: Set net.ipv4.conf.all.secure_redirects = 0 in /etc/sysctl.conf
/etc/sysctl.conf:net.ipv4.conf.all.secure_redirects = 0
/etc/sysctl.conf:# Per CCE-84003-3: Set net.ipv4.conf.default.accept_redirects = 0 in /etc/sysctl.conf
/etc/sysctl.conf:net.ipv4.conf.default.accept_redirects = 0
/etc/sysctl.conf:# Per CCE-84009-0: Set net.ipv4.conf.default.rp_filter = 1 in /etc/sysctl.conf
/etc/sysctl.conf:net.ipv4.conf.default.rp_filter = 1
/etc/sysctl.conf:# Per CCE-84019-9: Set net.ipv4.conf.default.secure_redirects = 0 in /etc/sysctl.conf
/etc/sysctl.conf:net.ipv4.conf.default.secure_redirects = 0
/etc/sysctl.conf:# Per CCE-84004-1: Set net.ipv4.icmp_echo_ignore_broadcasts = 1 in /etc/sysctl.conf
/etc/sysctl.conf:net.ipv4.icmp_echo_ignore_broadcasts = 1
/etc/sysctl.conf:# Per CCE-84006-6: Set net.ipv4.tcp_syncookies = 1 in /etc/sysctl.conf
/etc/sysctl.conf:net.ipv4.tcp_syncookies = 1
/etc/sysctl.conf:# Per CCE-83998-5: Set net.ipv4.ip_forward = 0 in /etc/sysctl.conf
/etc/sysctl.conf:net.ipv4.ip_forward = 0
/etc/sysctl.d/99-sysctl.conf:# Per CCE-84011-6: Set net.ipv4.conf.all.accept_redirects = 0 in /etc/sysctl.conf
/etc/sysctl.d/99-sysctl.conf:net.ipv4.conf.all.accept_redirects = 0
/etc/sysctl.d/99-sysctl.conf:# Per CCE-84001-7: Set net.ipv4.conf.all.accept_source_route = 0 in /etc/sysctl.conf
/etc/sysctl.d/99-sysctl.conf:net.ipv4.conf.all.accept_source_route = 0
/etc/sysctl.d/99-sysctl.conf:# Per CCE-84008-2: Set net.ipv4.conf.all.rp_filter = 1 in /etc/sysctl.conf
/etc/sysctl.d/99-sysctl.conf:net.ipv4.conf.all.rp_filter = 1
/etc/sysctl.d/99-sysctl.conf:# Per CCE-84016-5: Set net.ipv4.conf.all.secure_redirects = 0 in /etc/sysctl.conf
/etc/sysctl.d/99-sysctl.conf:net.ipv4.conf.all.secure_redirects = 0
/etc/sysctl.d/99-sysctl.conf:# Per CCE-84003-3: Set net.ipv4.conf.default.accept_redirects = 0 in /etc/sysctl.conf
/etc/sysctl.d/99-sysctl.conf:net.ipv4.conf.default.accept_redirects = 0
/etc/sysctl.d/99-sysctl.conf:# Per CCE-84009-0: Set net.ipv4.conf.default.rp_filter = 1 in /etc/sysctl.conf
/etc/sysctl.d/99-sysctl.conf:net.ipv4.conf.default.rp_filter = 1
/etc/sysctl.d/99-sysctl.conf:# Per CCE-84019-9: Set net.ipv4.conf.default.secure_redirects = 0 in /etc/sysctl.conf
/etc/sysctl.d/99-sysctl.conf:net.ipv4.conf.default.secure_redirects = 0
/etc/sysctl.d/99-sysctl.conf:# Per CCE-84004-1: Set net.ipv4.icmp_echo_ignore_broadcasts = 1 in /etc/sysctl.conf
/etc/sysctl.d/99-sysctl.conf:net.ipv4.icmp_echo_ignore_broadcasts = 1
/etc/sysctl.d/99-sysctl.conf:# Per CCE-84006-6: Set net.ipv4.tcp_syncookies = 1 in /etc/sysctl.conf
/etc/sysctl.d/99-sysctl.conf:net.ipv4.tcp_syncookies = 1
/etc/sysctl.d/99-sysctl.conf:# Per CCE-83998-5: Set net.ipv4.ip_forward = 0 in /etc/sysctl.conf
/etc/sysctl.d/99-sysctl.conf:net.ipv4.ip_forward = 0

----

IPv6 Status:
[source, bash]
----

----

{set:cellbgcolor!}
TCP/IP Security Setting Summary:
|===
|Parameter|Current Value|Expected Value|Status

|net.ipv4.conf.default.rp_filter|1|1|OK
|net.ipv4.conf.all.accept_source_route|0|0|OK
|net.ipv4.conf.default.accept_source_route|0|0|OK
|net.ipv4.ip_forward|0|0|OK
|net.ipv4.tcp_syncookies|1|1|OK
|net.ipv4.conf.all.rp_filter|1|1|OK
|net.ipv4.icmp_echo_ignore_broadcasts|1|1|OK
|net.ipv4.conf.all.accept_redirects|Not set|0|Missing
|net.ipv4.conf.default.accept_redirects|0|0|OK
|net.ipv4.conf.all.secure_redirects|0|0|OK
|net.ipv4.conf.default.secure_redirects|0|0|OK
|===

**Observation**

Found 1 missing TCP/IP security settings

**Recommendation**

Configure the following sysctl parameters:

Set net.ipv4.conf.all.accept_redirects = 0

Apply settings with: 'sysctl -p' and make them persistent in /etc/sysctl.conf

*Reference Link(s)*

* https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/8/html/security_hardening/

<<<

{set:cellbgcolor!}

# Updates

[cols="1,2,2,3", options=header]
|===
|*Category*
|*Item Evaluated*
|*Observed Result*
|*Recommendation*

// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/packages-repositories.item

// Category
|
{set:cellbgcolor!}
Updates

// Item Evaluated
a|
<<Enabled Repositories>>

| No repositories appear to be enabled 

| 
{set:cellbgcolor:#FEFE20}
Changes Recommended

// ------------------------ITEM END
// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/packages-security.item

// Category
|
{set:cellbgcolor!}
Updates

// Item Evaluated
a|
<<Security Patches>>

| System appears to have all security patches applied 

| 
{set:cellbgcolor:#00FF00}
No Change

// ------------------------ITEM END
// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/packages-unnecessary.item

// Category
|
{set:cellbgcolor!}
Updates

// Item Evaluated
a|
<<Unnecessary Packages>>

| No unnecessary or outdated packages detected 

| 
{set:cellbgcolor:#00FF00}
No Change

// ------------------------ITEM END
// ------------------------ITEM START
// ----ITEM SOURCE:  ./content/healthcheck-items/packages-kernel.item

// Category
|
{set:cellbgcolor!}
Updates

// Item Evaluated
a|
<<Kernel Consistency>>

| Found 1 kernel consistency issues 

| 
{set:cellbgcolor:#FEFE20}
Changes Recommended

// ------------------------ITEM END
|===

== Enabled Repositories

[cols="^"] 
|===
|
{set:cellbgcolor:#FEFE20}
Changes Recommended
|===

Enabled Repositories:
[source, bash]
----
Updating Subscription Management repositories.
Unable to read consumer identity

This system is not registered with an entitlement server. You can use "rhc" or "subscription-manager" to register.

YUM version: 4.14.0
cachedir: /var/cache/dnf

----

Repository Configuration Files:
[source, bash]
----
-rw-r--r--. 1 root root 358 Aug  6 09:39 redhat.repo

----

RHEL Version:
[source, bash]
----

----

**Observation**

No repositories appear to be enabled

**Recommendation**

Check system registration status

Enable appropriate repositories for your RHEL version

*Reference Link(s)*

* https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/8/html/configuring_basic_system_settings

== Security Patches

[cols="^"] 
|===
|
{set:cellbgcolor:#00FF00}
No Change
|===

Security Updates Available:
[source, bash]
----
Unable to read consumer identity

This system is not registered with an entitlement server. You can use "rhc" or "subscription-manager" to register.


----

Update Information Summary:
[source, bash]
----
Unable to read consumer identity

This system is not registered with an entitlement server. You can use "rhc" or "subscription-manager" to register.


----

Last Updated Packages:
[source, bash]
----
sg3_utils-1.47-10.el9.x86_64                  Wed 06 Aug 2025 09:10:29 AM +03
rootfiles-8.1-34.el9.noarch                   Wed 06 Aug 2025 09:10:29 AM +03
qemu-guest-agent-9.1.0-15.el9.x86_64          Wed 06 Aug 2025 09:10:29 AM +03
prefixdevname-0.1.0-8.el9.x86_64              Wed 06 Aug 2025 09:10:29 AM +03

----

Yum Update History:
[source, bash]
----
Unable to read consumer identity

This system is not registered with an entitlement server. You can use "rhc" or "subscription-manager" to register.


----

**Observation**

System appears to have all security patches applied

**Recommendation**

None

*Reference Link(s)*

* https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/

== Unnecessary Packages

[cols="^"] 
|===
|
{set:cellbgcolor:#00FF00}
No Change
|===

Obsolete Packages:
[source, bash]
----
Unable to read consumer identity

This system is not registered with an entitlement server. You can use "rhc" or "subscription-manager" to register.

No obsolete packages

----

Duplicate Packages:
[source, bash]
----

----

Installed Kernel Packages:
[source, bash]
----

----

Current Running Kernel:
[source, bash]
----

----

**Observation**

No unnecessary or outdated packages detected

**Recommendation**

None

*Reference Link(s)*

* https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/

== Kernel Consistency

[cols="^"] 
|===
|
{set:cellbgcolor:#FEFE20}
Changes Recommended
|===

Current Running Kernel:
[source, bash]
----

----

Installed Kernel Packages:
[source, bash]
----

----

Latest Available Kernel:
[source, bash]
----

----

Repository Metadata Status:
[source, bash]
----
Could not determine repository metadata age

----

Loaded Kernel Modules (Top 10):
[source, bash]
----
tls                   159744  0
binfmt_misc            28672  1
nft_fib_inet           12288  1
nft_fib_ipv4           12288  1 nft_fib_inet
nft_fib_ipv6           12288  1 nft_fib_inet
nft_fib                12288  3 nft_fib_ipv6,nft_fib_ipv4,nft_fib_inet
nft_reject_inet        12288  6
nf_reject_ipv4         16384  1 nft_reject_inet
nf_reject_ipv6         24576  1 nft_reject_inet

----

Kernel Version Status Summary:
[source, text]
----
Running kernel: 
Latest available kernel: 
Formatted for comparison: 
Repository metadata age: 20306 days
Running latest kernel: true

----

**Observation**

Found 1 kernel consistency issues

**Recommendation**

Repository metadata is 20306 days old - unable to reliably determine if latest kernel is installed

Refresh repository metadata with 'subscription-manager refresh'

For disconnected environments, sync content from Satellite server

*Reference Link(s)*

* https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/8/html/managing_monitoring_and_updating_the_kernel/index

<<<

{set:cellbgcolor!}

// Reset bgcolor for future tables
[grid=none,frame=none]
|===
|{set:cellbgcolor!}
|===

